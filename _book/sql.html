<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 SQL | DataManagement.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 SQL | DataManagement.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 SQL | DataManagement.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-relational-model-and-relational-algebra.html"/>
<link rel="next" href="reference-2-sql-playbook.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="data-management-databases-and-organizations.html"><a href="data-management-databases-and-organizations.html"><i class="fa fa-check"></i>Data Management: Databases and Organizations</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#supplements"><i class="fa fa-check"></i>Supplements</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="section-1-the-managerial-perspective.html"><a href="section-1-the-managerial-perspective.html"><i class="fa fa-check"></i>Section 1 The Managerial Perspective</a></li>
<li class="chapter" data-level="1" data-path="managing-data.html"><a href="managing-data.html"><i class="fa fa-check"></i><b>1</b> Managing Data</a>
<ul>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#learning-objectives"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#individual-data-management"><i class="fa fa-check"></i>Individual data management</a></li>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#organizational-data-management"><i class="fa fa-check"></i>Organizational data management</a></li>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#problems-with-data-management-systems"><i class="fa fa-check"></i>Problems with data management systems</a></li>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#a-brief-history-of-data-management-systems"><i class="fa fa-check"></i>A brief history of data management systems</a></li>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#data-information-and-knowledge"><i class="fa fa-check"></i>Data, information, and knowledge</a></li>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#the-challenge"><i class="fa fa-check"></i>The challenge</a></li>
<li class="chapter" data-level="" data-path="managing-data.html"><a href="managing-data.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="information.html"><a href="information.html"><i class="fa fa-check"></i><b>2</b> Information</a>
<ul>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#learning-objectives-1"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#a-historical-perspective"><i class="fa fa-check"></i>A historical perspective</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#a-brief-history-of-information-systems"><i class="fa fa-check"></i>A brief history of information systems</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-characteristics"><i class="fa fa-check"></i>Information characteristics</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-hardness"><i class="fa fa-check"></i>Information hardness</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-richness"><i class="fa fa-check"></i>Information richness</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-classes"><i class="fa fa-check"></i>Information classes</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-and-organizational-change"><i class="fa fa-check"></i>Information and organizational change</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#goal-setting-information"><i class="fa fa-check"></i>Goal-setting information</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#gap-information"><i class="fa fa-check"></i>Gap information</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#change-information"><i class="fa fa-check"></i>Change information</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#problem-solution"><i class="fa fa-check"></i>Problem solution</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-as-a-means-of-change"><i class="fa fa-check"></i>Information as a means of change</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#marketing"><i class="fa fa-check"></i>Marketing</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#customer-service"><i class="fa fa-check"></i>Customer Service</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#empowerment"><i class="fa fa-check"></i>Empowerment</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-and-managerial-work"><i class="fa fa-check"></i>Information and managerial work</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#managers-information-requirements"><i class="fa fa-check"></i>Managers’ information requirements</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#managers-needs-for-information-vary-accordingly-with-responsibilities"><i class="fa fa-check"></i>Managers’ needs for information vary accordingly with responsibilities</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-satisficing"><i class="fa fa-check"></i>Information satisficing</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-delivery-systems"><i class="fa fa-check"></i>Information delivery systems</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#information-integration"><i class="fa fa-check"></i>Information integration</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#knowledge-1"><i class="fa fa-check"></i>Knowledge</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#summary-1"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#references-and-additional-readings-1"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="information.html"><a href="information.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="section-2-data-modeling-and-sql.html"><a href="section-2-data-modeling-and-sql.html"><i class="fa fa-check"></i>Section 2 Data Modeling and SQL</a></li>
<li class="chapter" data-level="3" data-path="the-single-entity.html"><a href="the-single-entity.html"><i class="fa fa-check"></i><b>3</b> The Single Entity</a>
<ul>
<li class="chapter" data-level="" data-path="the-single-entity.html"><a href="the-single-entity.html#the-relational-model"><i class="fa fa-check"></i>The relational model</a></li>
<li class="chapter" data-level="" data-path="the-single-entity.html"><a href="the-single-entity.html#getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="the-single-entity.html"><a href="the-single-entity.html#modeling-a-single-entity-database"><i class="fa fa-check"></i>Modeling a single-entity database</a></li>
<li class="chapter" data-level="" data-path="the-single-entity.html"><a href="the-single-entity.html#creating-a-single-table-database"><i class="fa fa-check"></i>Creating a single-table database</a></li>
<li class="chapter" data-level="" data-path="the-single-entity.html"><a href="the-single-entity.html#summary-2"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="the-single-entity.html"><a href="the-single-entity.html#key-terms-and-concepts"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="the-single-entity.html"><a href="the-single-entity.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-one-to-many-relationship.html"><a href="the-one-to-many-relationship.html"><i class="fa fa-check"></i><b>4</b> The One-to-Many Relationship</a>
<ul>
<li class="chapter" data-level="" data-path="the-one-to-many-relationship.html"><a href="the-one-to-many-relationship.html#relationships"><i class="fa fa-check"></i>Relationships</a></li>
<li class="chapter" data-level="" data-path="the-one-to-many-relationship.html"><a href="the-one-to-many-relationship.html#creating-a-database-with-a-1m-relationship"><i class="fa fa-check"></i>Creating a database with a 1:m relationship</a></li>
<li class="chapter" data-level="" data-path="the-one-to-many-relationship.html"><a href="the-one-to-many-relationship.html#querying-a-two-table-database"><i class="fa fa-check"></i>Querying a two-table database</a></li>
<li class="chapter" data-level="" data-path="the-one-to-many-relationship.html"><a href="the-one-to-many-relationship.html#summary-3"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="the-one-to-many-relationship.html"><a href="the-one-to-many-relationship.html#key-terms-and-concepts-1"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="the-one-to-many-relationship.html"><a href="the-one-to-many-relationship.html#exercises-3"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-many-to-many-relationship.html"><a href="the-many-to-many-relationship.html"><i class="fa fa-check"></i><b>5</b> The Many-to-Many Relationship</a>
<ul>
<li class="chapter" data-level="" data-path="the-many-to-many-relationship.html"><a href="the-many-to-many-relationship.html#the-many-to-many-relationship-1"><i class="fa fa-check"></i>The many-to-many relationship</a></li>
<li class="chapter" data-level="" data-path="the-many-to-many-relationship.html"><a href="the-many-to-many-relationship.html#creating-a-relational-database-with-an-mm-relationship"><i class="fa fa-check"></i>Creating a relational database with an m:m relationship</a></li>
<li class="chapter" data-level="" data-path="the-many-to-many-relationship.html"><a href="the-many-to-many-relationship.html#querying-an-mm-relationship"><i class="fa fa-check"></i>Querying an m:m relationship</a></li>
<li class="chapter" data-level="" data-path="the-many-to-many-relationship.html"><a href="the-many-to-many-relationship.html#summary-4"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="the-many-to-many-relationship.html"><a href="the-many-to-many-relationship.html#key-terms-and-concepts-2"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="the-many-to-many-relationship.html"><a href="the-many-to-many-relationship.html#exercises-4"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html"><i class="fa fa-check"></i><b>6</b> One-to-One and Recursive Relationships</a>
<ul>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#learning-objectives-5"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#modeling-a-one-to-one-relationship"><i class="fa fa-check"></i>Modeling a one-to-one relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#mapping-a-one-to-one-relationship"><i class="fa fa-check"></i>Mapping a one-to-one relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#mapping-a-recursive-one-to-many-relationship"><i class="fa fa-check"></i>Mapping a recursive one-to-many relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#querying-a-one-to-one-relationship"><i class="fa fa-check"></i>Querying a one-to-one relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#querying-a-recursive-1m-relationship"><i class="fa fa-check"></i>Querying a recursive 1:m relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#modeling-a-recursive-one-to-one-relationship"><i class="fa fa-check"></i>Modeling a recursive one-to-one relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#mapping-a-recursive-one-to-one-relationship"><i class="fa fa-check"></i>Mapping a recursive one-to-one relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#querying-a-recursive-one-to-one-relationship"><i class="fa fa-check"></i>Querying a recursive one-to-one relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#modeling-a-recursive-many-to-many-relationship"><i class="fa fa-check"></i>Modeling a recursive many-to-many relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#mapping-a-recursive-many-to-many-relationship"><i class="fa fa-check"></i>Mapping a recursive many-to-many relationship</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#summary-5"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#key-terms-and-concepts-3"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-modeling.html"><a href="data-modeling.html"><i class="fa fa-check"></i><b>7</b> Data Modeling</a>
<ul>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#modeling"><i class="fa fa-check"></i>Modeling</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#data-modeling-1"><i class="fa fa-check"></i>Data modeling</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#the-building-blocks"><i class="fa fa-check"></i>The building blocks</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#data-model-quality"><i class="fa fa-check"></i>Data model quality</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#quality-improvement"><i class="fa fa-check"></i>Quality improvement</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#meaningful-identifiers"><i class="fa fa-check"></i>Meaningful identifiers</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#the-seven-habits-of-highly-effective-data-modelers"><i class="fa fa-check"></i>The seven habits of highly effective data modelers</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#summary-7"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#key-terms-and-concepts-4"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#references-and-additional-readings-2"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="data-modeling.html"><a href="data-modeling.html#exercises-5"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reference-1-basic-structures.html"><a href="reference-1-basic-structures.html"><i class="fa fa-check"></i>Reference 1: Basic Structures</a>
<ul>
<li class="chapter" data-level="" data-path="reference-1-basic-structures.html"><a href="reference-1-basic-structures.html#one-entity"><i class="fa fa-check"></i>One entity</a></li>
<li class="chapter" data-level="" data-path="reference-1-basic-structures.html"><a href="reference-1-basic-structures.html#two-entities"><i class="fa fa-check"></i>Two entities</a></li>
<li class="chapter" data-level="" data-path="reference-1-basic-structures.html"><a href="reference-1-basic-structures.html#another-entitys-identifier-as-part-of-the-identifier"><i class="fa fa-check"></i>Another entity’s identifier as part of the identifier</a></li>
<li class="chapter" data-level="" data-path="reference-1-basic-structures.html"><a href="reference-1-basic-structures.html#exercises-6"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="normalization-and-other-data-modeling-methods.html"><a href="normalization-and-other-data-modeling-methods.html"><i class="fa fa-check"></i><b>8</b> Normalization and Other Data Modeling Methods</a>
<ul>
<li class="chapter" data-level="" data-path="normalization-and-other-data-modeling-methods.html"><a href="normalization-and-other-data-modeling-methods.html#normalization"><i class="fa fa-check"></i>Normalization</a></li>
<li class="chapter" data-level="" data-path="normalization-and-other-data-modeling-methods.html"><a href="normalization-and-other-data-modeling-methods.html#other-data-modeling-methods"><i class="fa fa-check"></i>Other data modeling methods</a></li>
<li class="chapter" data-level="" data-path="normalization-and-other-data-modeling-methods.html"><a href="normalization-and-other-data-modeling-methods.html#summary-8"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="normalization-and-other-data-modeling-methods.html"><a href="normalization-and-other-data-modeling-methods.html#key-terms-and-concepts-5"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="normalization-and-other-data-modeling-methods.html"><a href="normalization-and-other-data-modeling-methods.html#references-and-additional-readings-3"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="normalization-and-other-data-modeling-methods.html"><a href="normalization-and-other-data-modeling-methods.html#exercises-7"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html"><i class="fa fa-check"></i><b>9</b> The Relational Model and Relational Algebra</a>
<ul>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#data-structures"><i class="fa fa-check"></i>Data structures</a></li>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#integrity-rules"><i class="fa fa-check"></i>Integrity rules</a></li>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#manipulation-languages"><i class="fa fa-check"></i>Manipulation languages</a></li>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#a-primitive-set-of-relational-operators"><i class="fa fa-check"></i>A primitive set of relational operators</a></li>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#a-fully-relational-database"><i class="fa fa-check"></i>A fully relational database</a></li>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#summary-9"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#key-terms-and-concepts-6"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#references-and-additional-readings-4"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html#exercises-8"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>10</b> SQL</a>
<ul>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#introduction-3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#data-definition"><i class="fa fa-check"></i>Data definition</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#keys"><i class="fa fa-check"></i>Keys</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#indexes"><i class="fa fa-check"></i>Indexes</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#notation"><i class="fa fa-check"></i>Notation</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#creating-a-table"><i class="fa fa-check"></i>Creating a table</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#constraints"><i class="fa fa-check"></i>Constraints</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#data-types"><i class="fa fa-check"></i>Data types</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#collation-sequence"><i class="fa fa-check"></i>Collation sequence</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#scalar-functions"><i class="fa fa-check"></i>Scalar functions</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#formatting"><i class="fa fa-check"></i>Formatting</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#altering-a-table"><i class="fa fa-check"></i>Altering a table</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#dropping-a-table"><i class="fa fa-check"></i>Dropping a table</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#creating-a-view"><i class="fa fa-check"></i>Creating a view</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#dropping-a-view"><i class="fa fa-check"></i>Dropping a view</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#creating-an-index"><i class="fa fa-check"></i>Creating an index</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#dropping-an-index"><i class="fa fa-check"></i>Dropping an index</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#data-manipulation"><i class="fa fa-check"></i>Data manipulation</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#qualifying-column-names"><i class="fa fa-check"></i>Qualifying column names</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#temporary-names"><i class="fa fa-check"></i>Temporary names</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#select"><i class="fa fa-check"></i>SELECT</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#insert"><i class="fa fa-check"></i>INSERT</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#update-1"><i class="fa fa-check"></i>UPDATE</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#delete-1"><i class="fa fa-check"></i>DELETE</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-routines"><i class="fa fa-check"></i>SQL routines</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-function"><i class="fa fa-check"></i>SQL function</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-procedure"><i class="fa fa-check"></i>SQL procedure</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#trigger"><i class="fa fa-check"></i>Trigger</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#nullsmuch-ado-about-missing-information"><i class="fa fa-check"></i>Nulls—much ado about missing information</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#security"><i class="fa fa-check"></i>Security</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#grant"><i class="fa fa-check"></i>GRANT</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#revoke"><i class="fa fa-check"></i>REVOKE</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#the-system-catalog"><i class="fa fa-check"></i>The system catalog</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#natural-language-processing"><i class="fa fa-check"></i>Natural language processing</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#connectivity-and-odbc"><i class="fa fa-check"></i>Connectivity and ODBC</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#open-database-connectivity-odbc"><i class="fa fa-check"></i>Open database connectivity (ODBC)</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#embedded-sql"><i class="fa fa-check"></i>Embedded SQL</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#user-defined-types"><i class="fa fa-check"></i>User-defined types</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#the-future-of-sql"><i class="fa fa-check"></i>The future of SQL</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#summary-10"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#key-terms-and-concepts-7"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#references-and-additional-readings-5"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#exercises-9"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reference-2-sql-playbook.html"><a href="reference-2-sql-playbook.html"><i class="fa fa-check"></i>Reference 2: SQL Playbook</a>
<ul>
<li class="chapter" data-level="" data-path="reference-2-sql-playbook.html"><a href="reference-2-sql-playbook.html#the-power-of-sql"><i class="fa fa-check"></i>The power of SQL</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="section-3-advanced-data-management.html"><a href="section-3-advanced-data-management.html"><i class="fa fa-check"></i>Section 3 Advanced Data Management</a></li>
<li class="chapter" data-level="11" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html"><i class="fa fa-check"></i><b>11</b> Spatial and Temporal Data Management</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html#learning-objectives-10"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html#introduction-4"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html#managing-spatial-data"><i class="fa fa-check"></i>Managing spatial data</a></li>
<li class="chapter" data-level="" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html#managing-temporal-data"><i class="fa fa-check"></i>Managing temporal data</a></li>
<li class="chapter" data-level="" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html#summary-11"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html#key-terms-and-concepts-8"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html#references-and-additional-readings-6"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html#exercises-10"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="graph-databases.html"><a href="graph-databases.html"><i class="fa fa-check"></i><b>12</b> Graph Databases</a>
<ul>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#a-graph-database"><i class="fa fa-check"></i>A graph database</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#neo4j-a-graph-database-implementation"><i class="fa fa-check"></i>Neo4j – a graph database implementation</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#a-single-node"><i class="fa fa-check"></i>A single node</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#querying-a-node"><i class="fa fa-check"></i>Querying a node</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#a-relationship-between-nodes"><i class="fa fa-check"></i>A relationship between nodes</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#querying-an-mm-relationship-1"><i class="fa fa-check"></i>Querying an m:m relationship</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#recursive-relationships"><i class="fa fa-check"></i>Recursive relationships</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#summary-12"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#key-terms-and-concepts-9"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#references-and-additional-resources"><i class="fa fa-check"></i>References and additional resources</a></li>
<li class="chapter" data-level="" data-path="graph-databases.html"><a href="graph-databases.html#exercises-11"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="xml-managing-data-exchange.html"><a href="xml-managing-data-exchange.html"><i class="fa fa-check"></i><b>13</b> XML: Managing Data Exchange</a>
<ul>
<li class="chapter" data-level="" data-path="xml-managing-data-exchange.html"><a href="xml-managing-data-exchange.html#sgml"><i class="fa fa-check"></i>SGML</a></li>
<li class="chapter" data-level="" data-path="xml-managing-data-exchange.html"><a href="xml-managing-data-exchange.html#xml"><i class="fa fa-check"></i>XML</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html"><i class="fa fa-check"></i><b>14</b> Organizational Intelligence</a>
<ul>
<li class="chapter" data-level="" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html#the-data-warehouse"><i class="fa fa-check"></i>The data warehouse</a></li>
<li class="chapter" data-level="" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html#exploiting-data-stores"><i class="fa fa-check"></i>Exploiting data stores</a></li>
<li class="chapter" data-level="" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html#olap"><i class="fa fa-check"></i>OLAP</a></li>
<li class="chapter" data-level="" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html#data-mining"><i class="fa fa-check"></i>Data mining</a></li>
<li class="chapter" data-level="" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html#summary-14"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html#key-terms-and-concepts-11"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html#references-and-additional-readings-8"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html#exercises-13"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>15</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#the-r-project"><i class="fa fa-check"></i>The R project</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#database-access"><i class="fa fa-check"></i>Database access</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#timestamps"><i class="fa fa-check"></i>Timestamps</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#excel-files"><i class="fa fa-check"></i>Excel files</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-resources"><i class="fa fa-check"></i>R resources</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-and-data-analytics"><i class="fa fa-check"></i>R and data analytics</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#summary-15"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#key-terms-and-concepts-12"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercises-14"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="data-visualization-1.html"><a href="data-visualization-1.html"><i class="fa fa-check"></i><b>16</b> Data visualization</a>
<ul>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#visual-processing"><i class="fa fa-check"></i>Visual processing</a></li>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#the-grammar-of-graphics"><i class="fa fa-check"></i>The grammar of graphics</a></li>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#ggplot2"><i class="fa fa-check"></i>ggplot2</a></li>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#some-recipes"><i class="fa fa-check"></i>Some recipes</a></li>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#geographic-data"><i class="fa fa-check"></i>Geographic data</a></li>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#r-resources-1"><i class="fa fa-check"></i>R resources</a></li>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#summary-16"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#references-1"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="data-visualization-1.html"><a href="data-visualization-1.html#exercises-15"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html"><i class="fa fa-check"></i><b>17</b> Text mining &amp; natural language processing</a>
<ul>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#the-nature-of-language"><i class="fa fa-check"></i>The nature of language</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#levels-of-processing"><i class="fa fa-check"></i>Levels of processing</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#tokenization"><i class="fa fa-check"></i>Tokenization</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#sentiment-analysis"><i class="fa fa-check"></i>Sentiment analysis</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#corpus"><i class="fa fa-check"></i>Corpus</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#readability"><i class="fa fa-check"></i>Readability</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#preprocessing"><i class="fa fa-check"></i>Preprocessing</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#word-frequency-analysis"><i class="fa fa-check"></i>Word frequency analysis</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#co-occurrence-and-association"><i class="fa fa-check"></i>Co-occurrence and association</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#cluster-analysis"><i class="fa fa-check"></i>Cluster analysis</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#topic-modeling"><i class="fa fa-check"></i>Topic modeling</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#named-entity-recognition-ner"><i class="fa fa-check"></i>Named-entity recognition (NER)</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#future-developments"><i class="fa fa-check"></i>Future developments</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#summary-17"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#key-terms-and-concepts-13"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#references-2"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html#exercises-16"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="cluster-computing.html"><a href="cluster-computing.html"><i class="fa fa-check"></i><b>18</b> Cluster computing</a>
<ul>
<li class="chapter" data-level="" data-path="cluster-computing.html"><a href="cluster-computing.html#a-paradigm-shift"><i class="fa fa-check"></i>A paradigm shift</a></li>
<li class="chapter" data-level="" data-path="cluster-computing.html"><a href="cluster-computing.html#the-drivers"><i class="fa fa-check"></i>The drivers</a></li>
<li class="chapter" data-level="" data-path="cluster-computing.html"><a href="cluster-computing.html#the-bottleneck-and-its-solution"><i class="fa fa-check"></i>The bottleneck and its solution</a></li>
<li class="chapter" data-level="" data-path="cluster-computing.html"><a href="cluster-computing.html#lambda-architecture"><i class="fa fa-check"></i>Lambda Architecture</a></li>
<li class="chapter" data-level="" data-path="cluster-computing.html"><a href="cluster-computing.html#hadoop"><i class="fa fa-check"></i>Hadoop</a></li>
<li class="chapter" data-level="" data-path="cluster-computing.html"><a href="cluster-computing.html#spark"><i class="fa fa-check"></i>Spark</a></li>
<li class="chapter" data-level="" data-path="cluster-computing.html"><a href="cluster-computing.html#summary-18"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>19</b> Dashboards</a>
<ul>
<li class="chapter" data-level="" data-path="dashboards.html"><a href="dashboards.html#the-value-of-dashboards"><i class="fa fa-check"></i>The value of dashboards</a></li>
<li class="chapter" data-level="" data-path="dashboards.html"><a href="dashboards.html#summary-19"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="section-4-managing-organizational-memory.html"><a href="section-4-managing-organizational-memory.html"><i class="fa fa-check"></i>Section 4 Managing Organizational Memory</a></li>
<li class="chapter" data-level="20" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html"><i class="fa fa-check"></i><b>20</b> Data Structure and Storage</a>
<ul>
<li class="chapter" data-level="" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html#the-data-deluge"><i class="fa fa-check"></i>The data deluge</a></li>
<li class="chapter" data-level="" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html#data-structures-1"><i class="fa fa-check"></i>Data structures</a></li>
<li class="chapter" data-level="" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html#data-coding-standards"><i class="fa fa-check"></i>Data coding standards</a></li>
<li class="chapter" data-level="" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html#data-storage-devices"><i class="fa fa-check"></i>Data storage devices</a></li>
<li class="chapter" data-level="" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html#data-compression"><i class="fa fa-check"></i>Data compression</a></li>
<li class="chapter" data-level="" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html#summary-20"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html#key-terms-and-concepts-15"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html#exercises-19"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html"><i class="fa fa-check"></i><b>21</b> Data Processing Architectures</a>
<ul>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#architectural-choices"><i class="fa fa-check"></i>Architectural choices</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#remote-job-entry"><i class="fa fa-check"></i>Remote job entry</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#personal-database"><i class="fa fa-check"></i>Personal database</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#clientserver"><i class="fa fa-check"></i>Client/server</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#cloud-computing"><i class="fa fa-check"></i>Cloud computing</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#distributed-database"><i class="fa fa-check"></i>Distributed database</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#distributed-data-access"><i class="fa fa-check"></i>Distributed data access</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#distributed-database-design"><i class="fa fa-check"></i>Distributed database design</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#summary-21"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#key-terms-and-concepts-16"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#references-and-additional-readings-10"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html#exercises-20"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="sql-and-java.html"><a href="sql-and-java.html"><i class="fa fa-check"></i><b>22</b> SQL and Java</a>
<ul>
<li class="chapter" data-level="" data-path="sql-and-java.html"><a href="sql-and-java.html#jdbc"><i class="fa fa-check"></i>JDBC</a></li>
<li class="chapter" data-level="" data-path="sql-and-java.html"><a href="sql-and-java.html#java-ee"><i class="fa fa-check"></i>Java EE</a></li>
<li class="chapter" data-level="" data-path="sql-and-java.html"><a href="sql-and-java.html#using-sql-within-java"><i class="fa fa-check"></i>Using SQL within Java</a></li>
<li class="chapter" data-level="" data-path="sql-and-java.html"><a href="sql-and-java.html#javaserver-pages-jsp"><i class="fa fa-check"></i>JavaServer Pages (JSP)</a></li>
<li class="chapter" data-level="" data-path="sql-and-java.html"><a href="sql-and-java.html#summary-22"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="sql-and-java.html"><a href="sql-and-java.html#key-terms-and-concepts-17"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="sql-and-java.html"><a href="sql-and-java.html#references-and-additional-readings-11"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="sql-and-java.html"><a href="sql-and-java.html#exercises-21"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="data-integrity.html"><a href="data-integrity.html"><i class="fa fa-check"></i><b>23</b> Data Integrity</a>
<ul>
<li class="chapter" data-level="" data-path="data-integrity.html"><a href="data-integrity.html#introduction-9"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="data-integrity.html"><a href="data-integrity.html#transaction-management"><i class="fa fa-check"></i>Transaction management</a></li>
<li class="chapter" data-level="" data-path="data-integrity.html"><a href="data-integrity.html#protecting-existence"><i class="fa fa-check"></i>Protecting existence</a></li>
<li class="chapter" data-level="" data-path="data-integrity.html"><a href="data-integrity.html#maintaining-data-quality"><i class="fa fa-check"></i>Maintaining data quality</a></li>
<li class="chapter" data-level="" data-path="data-integrity.html"><a href="data-integrity.html#ensuring-confidentiality"><i class="fa fa-check"></i>Ensuring confidentiality</a></li>
<li class="chapter" data-level="" data-path="data-integrity.html"><a href="data-integrity.html#summary-23"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="data-integrity.html"><a href="data-integrity.html#key-terms-and-concepts-18"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="data-integrity.html"><a href="data-integrity.html#exercises-22"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="data-administration.html"><a href="data-administration.html"><i class="fa fa-check"></i><b>24</b> Data Administration</a>
<ul>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#introduction-10"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#the-chief-data-officer"><i class="fa fa-check"></i>The Chief Data Officer</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#management-of-the-database-environment"><i class="fa fa-check"></i>Management of the database environment</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#data-administration-1"><i class="fa fa-check"></i>Data administration</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#database-management-systems-dbmss"><i class="fa fa-check"></i>Database management systems (DBMSs)</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#groupware-1"><i class="fa fa-check"></i>Groupware</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#data-integration"><i class="fa fa-check"></i>Data integration</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#conclusion-9"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#summary-24"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#key-terms-and-concepts-19"><i class="fa fa-check"></i>Key terms and concepts</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#references-and-additional-readings-12"><i class="fa fa-check"></i>References and additional readings</a></li>
<li class="chapter" data-level="" data-path="data-administration.html"><a href="data-administration.html#exercises-23"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sql" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> SQL</h1>
<blockquote>
<p><em>The questing beast</em>.</p>
<p>Sir Thomas Malory, <em>Le Morte D’Arthur</em>, 1470</p>
</blockquote>
<div id="learning-objectives-9" class="section level3 unnumbered">
<h3>Learning objectives</h3>
<p>Students completing this chapter will have a detailed knowledge of SQL.</p>
</div>
<div id="introduction-3" class="section level2 unnumbered">
<h2>Introduction</h2>
<p><strong>Structured query language</strong> (SQL) is widely used as a relational
database language, and SQL skills are essential for data management in a
world that is increasingly reliant on relational technology. SQL
originated in the IBM Research Laboratory in San Jose, California.
Versions have since been implemented by commercial database vendors and
open source teams for a wide range of operating systems. Both the
American National Standards Institute (ANSI) and the International
Organization for Standardization (ISO) have designated SQL as a standard
language for relational database systems.</p>
<p>SQL is a <strong>complete database language</strong>. It is used for defining a
relational database, creating views, and specifying queries. In
addition, it allows for rows to be inserted, updated, and deleted. In
database terminology, it is both a <strong>data definition language</strong> (DDL), a
<strong>data manipulation language</strong> (DML), and a <strong>data control language</strong>
(DCL). SQL, however, is not a complete programming language like PHP and
Java. Because SQL statements can be embedded into general-purpose
programming languages, SQL is often used in conjunction with such
languages to create application programs. The <strong>embedded SQL</strong>
statements handle the database processing, and the statements in the
general-purpose language perform the necessary tasks to complete the
application.</p>
<p>SQL is a declarative language, because you declare the desired results.
Languages such as Java are procedural languages, because the programmer
specifies each step the computer must execute. The SQL programmer can
focus on defining what is required rather than detailing the process to
achieve what is required. Thus, SQL programs are much shorter than their
procedural equivalents.</p>
<p>You were introduced to SQL in Chapters 3 through 6. This chapter
provides an integrated coverage of the language, pulling together the
various pieces presented previously.</p>
</div>
<div id="data-definition" class="section level2 unnumbered">
<h2>Data definition</h2>
<p>The DDL part of SQL encompasses statements to operate on tables, views,
and indexes. Before we proceed, however, the term “base table” must be
defined. A <strong>base table</strong> is an autonomous, named table. It is
autonomous because it exists in its own right; it is physically stored
within the database. In contrast, a view is not autonomous because it is
derived from one or more base tables and does not exist independently. A
view is a virtual table. A base table has a name by which it can be
referenced. This name is chosen when the base table is generated using
the CREATE statement. Short-lived temporary tables, such as those formed
as the result of a query, are not named.</p>
</div>
<div id="keys" class="section level2 unnumbered">
<h2>Keys</h2>
<p>The concept of a <strong>key</strong> occurs several times within SQL. In general, a
key is one or more columns identified as such in the description of a
table, an index, or a referential constraint. The same column can be
part of more than one key. For example, it can be part of a primary key
and a foreign key. A <strong>composite key</strong> is an ordered set of columns of
the same table. In other words, the primary key of <code>lineitem</code> is always
the composite of (<code>lineno</code>, <code>saleno</code>) in that order, which cannot be
changed.</p>
<p>Comparing composite keys actually means that corresponding components of
the keys are compared. Thus, application of the referential integrity
rule—<em>the value of a foreign key must be equal to a value of the
primary key</em> —means that each component of the foreign key must be
equal to the corresponding component of the composite primary key.</p>
<p>So far, you have met primary and foreign keys. A <strong>unique key</strong> is
another type of key. Its purpose is to ensure that no two values of a
given column are equal. This constraint is enforced by the DBMS during
the execution of INSERT and UPDATE statements. A unique key is part of
the index mechanism.</p>
</div>
<div id="indexes" class="section level2 unnumbered">
<h2>Indexes</h2>
<p>Indexes are used to accelerate data access and ensure uniqueness. An
<strong>index</strong> is an ordered set of pointers to rows of a base table. Think
of an index as a table that contains two columns. The first column
contains values for the index key, and the second contains a list of
addresses of rows in the table. Since the values in the first column are
ordered (i.e., in ascending or descending sequence), the index table can
be searched quickly. Once the required key has been found in the table,
the row’s address in the second column can be used to retrieve the data
quickly. An index can be specified as being unique, in which case the
DBMS ensures that the corresponding table does not have rows with
identical index keys.</p>
<p><em>An example of an index</em></p>
<p><img src="Figures/Chapter%2011/index.png" /></p>
</div>
<div id="notation" class="section level2 unnumbered">
<h2>Notation</h2>
<p>A short primer on notation is required before we examine SQL commands.</p>
<ol style="list-style-type: decimal">
<li><p>Text in uppercase is required as is.</p></li>
<li><p>Text in lowercase denotes values to be selected by the query writer.</p></li>
<li><p>Statements enclosed within square brackets are optional.</p></li>
<li><p>| indicates a choice.</p></li>
<li><p>An ellipsis (…) indicates that the immediate syntactic unit may be
repeated optionally more than once.</p></li>
</ol>
</div>
<div id="creating-a-table" class="section level2 unnumbered">
<h2>Creating a table</h2>
<p>CREATE TABLE is used to define a new base table, either interactively or
by embedding the statement in a host language. The statement specifies a
table’s name, provides details of its columns, and provides integrity
checks. The syntax of the command is</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb122-1"><a href="sql.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> base<span class="op">-</span><span class="kw">table</span></span>
<span id="cb122-2"><a href="sql.html#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">column</span><span class="op">-</span>definition<span class="op">-</span><span class="kw">block</span></span>
<span id="cb122-3"><a href="sql.html#cb122-3" aria-hidden="true" tabindex="-1"></a>    [<span class="kw">primary</span><span class="op">-</span><span class="kw">key</span><span class="op">-</span><span class="kw">block</span>]</span>
<span id="cb122-4"><a href="sql.html#cb122-4" aria-hidden="true" tabindex="-1"></a>    [referential<span class="op">-</span><span class="kw">constraint</span><span class="op">-</span><span class="kw">block</span>]</span>
<span id="cb122-5"><a href="sql.html#cb122-5" aria-hidden="true" tabindex="-1"></a>    [<span class="kw">unique</span><span class="op">-</span><span class="kw">block</span>];</span></code></pre></div>
<div id="column-definition" class="section level3 unnumbered">
<h3>Column definition</h3>
<p>The column definition block defines the columns in a table. Each column
definition consists of a column name, data type, and optionally the
specification that the column cannot contain null values. The general
form is</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb123-1"><a href="sql.html#cb123-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">column</span><span class="op">-</span>definition [, <span class="op">..</span>.])</span></code></pre></div>
<p>where column-definition is of the form</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb124-1"><a href="sql.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="kw">column</span><span class="op">-</span>name <span class="kw">data</span><span class="op">-</span><span class="kw">type</span> [<span class="kw">NOT</span> <span class="kw">NULL</span>]</span></code></pre></div>
<p>The NOT NULL clause specifies that the particular column must have a
value whenever a new row is inserted.</p>
</div>
</div>
<div id="constraints" class="section level2 unnumbered">
<h2>Constraints</h2>
<p>A constraint is a rule defined as part of CREATE TABLE that defines
valid sets of values for a base table by placing limits on INSERT,
UPDATE, and DELETE operations. Constraints can be named (e.g.,
<code>fk_stock_nation</code>) so that they can be turned on or off and modified.
The four constraint variations apply to primary key, foreign key, unique
values, and range checks.</p>
<div id="primary-key-constraint" class="section level3 unnumbered">
<h3>Primary key constraint</h3>
<p>The primary key constraint block specifies a set of columns that
constitute the primary key. Once a primary key is defined, the system
enforces its uniqueness by checking that the primary key of any new row
does not already exist in the table. A table can have only one primary
key. While it is not mandatory to define a primary key, it is good
practice always to define a table’s primary key, though it is not that
common to name the constraint. The general form of the constraint is</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb125-1"><a href="sql.html#cb125-1" aria-hidden="true" tabindex="-1"></a>[<span class="kw">primary</span><span class="op">-</span><span class="kw">key</span><span class="op">-</span>name] <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(<span class="kw">column</span><span class="op">-</span>name [<span class="kw">asc</span>|<span class="kw">desc</span>] [, <span class="op">..</span>.])</span></code></pre></div>
<p>The optional ASC or DESC clause specifies whether the values from this
key are arranged in ascending or descending order, respectively.</p>
<p>For example:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb126-1"><a href="sql.html#cb126-1" aria-hidden="true" tabindex="-1"></a>pk_stock <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(stkcode)</span></code></pre></div>
</div>
<div id="foreign-key-constraint" class="section level3 unnumbered">
<h3>Foreign key constraint</h3>
<p>The referential constraint block defines a foreign key, which consists
of one or more columns in the table that together must match a primary
key of the specified table (or else be null). A foreign key value is
null when any one of the columns in the row constituting the foreign key
is null. Once the foreign key constraint is defined, the DBMS will check
every insert and update to ensure that the constraint is observed. The
general form is</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb127-1"><a href="sql.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CONSTRAINT</span> <span class="kw">constraint</span><span class="op">-</span>name <span class="kw">FOREIGN</span> <span class="kw">KEY</span>(<span class="kw">column</span><span class="op">-</span>name [,…])</span>
<span id="cb127-2"><a href="sql.html#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">REFERENCES</span> <span class="kw">table</span><span class="op">-</span>name(<span class="kw">column</span><span class="op">-</span>name [,…]) </span>
<span id="cb127-3"><a href="sql.html#cb127-3" aria-hidden="true" tabindex="-1"></a>        [<span class="kw">ON</span> <span class="kw">DELETE</span> (<span class="kw">RESTRICT</span> | <span class="kw">CASCADE</span> | <span class="kw">SET</span> <span class="kw">NULL</span>)]</span></code></pre></div>
<p>The constraint-name defines a referential constraint. You cannot use the
same constraint-name more than once in the same table. Column-name
identifies the column or columns that comprise the foreign key. The data
type and length of foreign key columns must match exactly the data type
and length of the primary key columns. The clause REFERENCES table-name
specifies the name of an existing table, and its primary key, that
contains the primary key, which cannot be the name of the table being
created.</p>
<p>The ON DELETE clause defines the action taken when a row is deleted from
the table containing the primary key. There are three options:</p>
<ol style="list-style-type: decimal">
<li><p>RESTRICT prevents deletion of the primary key row until all
corresponding rows in the related table, the one containing the
foreign key, have been deleted. RESTRICT is the default and the
cautious approach for preserving data integrity.</p></li>
<li><p>CASCADE causes all the corresponding rows in the related table also
to be deleted.</p></li>
<li><p>SET NULLS sets the foreign key to null for all corresponding rows in
the related table.</p></li>
</ol>
<p>For example:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb128-1"><a href="sql.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CONSTRAINT</span> fk_stock_nation <span class="kw">FOREIGN</span> <span class="kw">KEY</span>(natcode) </span>
<span id="cb128-2"><a href="sql.html#cb128-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">REFERENCES</span> nation(natcode)</span></code></pre></div>
</div>
<div id="unique-constraint" class="section level3 unnumbered">
<h3>Unique constraint</h3>
<p>A unique constraint creates a unique index for the specified column or
columns. A unique key is constrained so that no two of its values are
equal. Columns appearing in a unique constraint must be defined as NOT
NULL. Also, these columns should not be the same as those of the table’s
primary key, which is guaranteed uniqueness by its primary key
definition. The constraint is enforced by the DBMS during execution of
INSERT and UPDATE statements. The general format is</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb129-1"><a href="sql.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">UNIQUE</span> <span class="kw">constraint</span><span class="op">-</span>name (<span class="kw">column</span><span class="op">-</span>name [<span class="kw">ASC</span>|<span class="kw">DESC</span>] [, …])</span></code></pre></div>
<p>An example follows:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb130-1"><a href="sql.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CONSTRAINT</span> unq_stock_stkname <span class="kw">UNIQUE</span>(stkname)</span></code></pre></div>
</div>
<div id="check-constraint" class="section level3 unnumbered">
<h3>Check constraint</h3>
<p>A check constraint defines a set of valid values and comes in three
forms: table, column, or domain constraint.</p>
<p><strong>Table constraints</strong> are defined in CREATE TABLE and ALTER TABLE
statements. They can be set for one or more columns. A table constraint,
for example, might limit itemcode to values less than 500.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb131-1"><a href="sql.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> item (</span>
<span id="cb131-2"><a href="sql.html#cb131-2" aria-hidden="true" tabindex="-1"></a>    itemcode <span class="dt">integer</span>,</span>
<span id="cb131-3"><a href="sql.html#cb131-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">CONSTRAINT</span> chk_item_itemcode <span class="kw">check</span>(itemcode <span class="op">&lt;</span><span class="dv">500</span>));</span></code></pre></div>
<p>A <strong>column constraint</strong> is defined in a CREATE TABLE statement and must
be for a single column. Once created, a column constraint is, in effect,
a table constraint. The following example shows that there is little
difference between defining a table and column constraint. In the
following case, itemcode is again limited to values less than 500.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb132-1"><a href="sql.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> item (</span>
<span id="cb132-2"><a href="sql.html#cb132-2" aria-hidden="true" tabindex="-1"></a>    itemcode <span class="dt">INTEGER</span> <span class="kw">CONSTRAINT</span> chk_item_itemcode <span class="kw">CHECK</span>(itemcode <span class="op">&lt;</span><span class="dv">500</span>),</span>
<span id="cb132-3"><a href="sql.html#cb132-3" aria-hidden="true" tabindex="-1"></a>    itemcolor <span class="dt">VARCHAR</span>(<span class="dv">10</span>));</span></code></pre></div>
<p>A <strong>domain constraint</strong> defines the legal values for a type of object
(e.g., an item’s color) that can be defined in one or more tables. The
following example sets legal values of color.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb133-1"><a href="sql.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">domain</span> valid_color <span class="kw">AS</span> <span class="dt">char</span>(<span class="dv">10</span>)</span>
<span id="cb133-2"><a href="sql.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CONSTRAINT</span> chk_qitem_color <span class="kw">check</span>( </span>
<span id="cb133-3"><a href="sql.html#cb133-3" aria-hidden="true" tabindex="-1"></a>     <span class="kw">IN</span> (<span class="st">&#39;Bamboo&#39;</span>,<span class="st">&#39;Black&#39;</span>,<span class="st">&#39;Brown&#39;</span>,<span class="st">&#39;Green&#39;</span>,<span class="st">&#39;Khaki&#39;</span>,<span class="st">&#39;White&#39;</span>));</span></code></pre></div>
<p>In a CREATE TABLE statement, instead of defining a column’s data type,
you specify the domain on which the column is defined. The following
example shows that itemcolor is defined on the domain valid_color.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb134-1"><a href="sql.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">table</span> item (</span>
<span id="cb134-2"><a href="sql.html#cb134-2" aria-hidden="true" tabindex="-1"></a>    itemcode <span class="dt">INTEGER</span>,</span>
<span id="cb134-3"><a href="sql.html#cb134-3" aria-hidden="true" tabindex="-1"></a>    itemcolor valid_color);</span></code></pre></div>
</div>
</div>
<div id="data-types" class="section level2 unnumbered">
<h2>Data types</h2>
<p>Some of the variety of data types that can be used are depicted in the
following figure and described in more detail in the following pages.</p>
<div id="boolean" class="section level3 unnumbered">
<h3>BOOLEAN</h3>
<p>Boolean data types can have the values true, false, or unknown.</p>
</div>
<div id="smallint-and-integer" class="section level3 unnumbered">
<h3>SMALLINT and INTEGER</h3>
<p>Most commercial computers have a 32-bit word, where a word is a unit of
storage. An integer can be stored in a full word or half a word. If it
is stored in a full word (INTEGER), then it can be 31 binary digits in
length. If half-word storage is used (SMALLINT), then it can be 15
binary digits long. In each case, one bit is used for the sign of the
number. A column defined as INTEGER can store a number in the range
–2<sup>31</sup> to 2<sup>31</sup>-1 or –2,147,483,648 to 2,147,483,647. A column defined
as SMALLINT can store a number in the range –2<sup>15</sup> to 2<sup>15</sup>-1 or
–32,768 to 32,767. Just remember that INTEGER is good for ±2 billion
and SMALLINT for ±32,000.</p>
</div>
<div id="float" class="section level3 unnumbered">
<h3>FLOAT</h3>
<p>Scientists often deal with numbers that are very large (e.g., Avogadro’s
number is 6.02252 ×10<sup>23</sup>) or very small (e.g., Planck’s constant is
6.6262 × 10<sup>–34</sup> joule sec). The FLOAT data type is used for storing
such numbers, often referred to as <em>floating-point</em> numbers. A
single-precision floating-point number requires 32 bits and can
represent numbers in the range –7.2 × 10<sup>75</sup> to –5.4 × 10<sup>–79</sup>, 0,
5.4 × 10<sup>–79</sup> to 7.2 × 10<sup>75</sup> with a precision of about 7 decimal
digits. A double-precision floating-point number requires 64 bits. The
range is the same as for a single-precision floating-point number. The
extra 32 bits are used to increase precision to about 15 decimal digits.</p>
<p>In the specification FLOAT(n), if <em>n</em> is between 1 and 21 inclusive,
single-precision floating-point is selected. If <em>n</em> is between 22 and 53
inclusive, the storage format is double-precision floating-point. If <em>n</em>
is not specified, double-precision floating-point is assumed.</p>
</div>
<div id="decimal" class="section level3 unnumbered">
<h3>DECIMAL</h3>
<p>Binary is the most convenient form of storing data from a computer’s
perspective. People, however, work with a decimal number system. The
DECIMAL data type is convenient for business applications because data
storage requirements are defined in terms of the maximum number of
places to the left and right of the decimal point. To store the current
value of an ounce of gold, you would possibly use DECIMAL(6,2) because
this would permit a maximum value of $9,999.99. Notice that the general
form is DECIMAL(p,q), where p is the total number of digits in the
column, and q is the number of digits to the right of the decimal point.</p>
<p><em>Data types</em></p>
<p><img src="Figures/Chapter%2010/data%20types.png" /></p>
</div>
<div id="char-and-varchar" class="section level3 unnumbered">
<h3>CHAR and VARCHAR</h3>
<p>Nonnumeric columns are stored as character strings. A person’s family
name is an example of a column that is stored as a character string.
CHAR(n) defines a column that has a fixed length of n characters, where
n can be a maximum of 255.</p>
<p>When a column’s length can vary greatly, it makes sense to define the
field as VARCHAR. A column defined as VARCHAR consists of two parts: a
header indicating the length of the character string and the string. If
a table contains a column that occasionally stores a long string of text
(e.g., a message field), then defining it as VARCHAR makes sense.
VARCHAR can store strings up to 65,535 characters long.</p>
<p>Why not store all character columns as VARCHAR and save space? There is
a price for using VARCHAR with some relational systems. <em>First</em>,
additional space is required for the header to indicate the length of
the string. <em>Second</em>, additional processing time is required to handle a
variable-length string compared to a fixed-length string. Depending on
the DBMS and processor speed, these might be important considerations,
and some systems will automatically make an appropriate choice. For
example, if you use both data types in the same table, MySQL will
automatically change CHAR into VARCHAR for compatibility reasons.</p>
<p>There are some columns where there is no trade-off decision because all
possible entries are always the same length. Canadian postal codes, for
instance, are always six characters (e.g., the postal code for Ottawa is
K1A0A1).</p>
<p>Data compression is another approach to the <em>space wars</em> problem. A
database can be defined with generous allowances for fixed-length
character columns so that few values are truncated. Data compression can
be used to compress the file to remove <em>wasted</em> space. Data compression,
however, is slow and will increase the time to process queries. You save
space at the cost of time, and save time at the cost of space. When
dealing with character fields, the database designer has to decide
whether time or space is more important.</p>
</div>
<div id="times-and-dates" class="section level3 unnumbered">
<h3>Times and dates</h3>
<p>Columns that have a data type of DATE are stored as <em>yyyymmdd</em> (e.g.,
2012-11-04 for November 4, 2012). There are two reasons for this format.
<em>First,</em> it is convenient for sorting in chronological order. The common
American way of writing dates (<em>mmddyy</em>) requires processing before
chronological sorting. <em>Second</em>, the full form of the year should be
recorded for exactness.</p>
<p>For similar reasons, it makes sense to store times in the form <em>hhmmss</em>
with the understanding that this is 24-hour time (also known as European
time and military time). This is the format used for data type TIME.</p>
<p>Some applications require precise recording of events. For example,
transaction processing systems typically record the time a transaction
was processed by the system. Because computers operate at high speed,
the TIMESTAMP data type records date and time with microsecond accuracy.
A timestamp has seven parts—year, month, day, hour, minute, second,
and microsecond. Date and time are defined as previously described
(i.e., <em>yyyymmdd</em> and <em>hhmmss</em>, respectively). The range of the
microsecond part is 000000 to 999999.</p>
<p>Although times and dates are stored in a particular format, the
formatting facilities that generally come with a DBMS usually allow
tailoring of time and date output to suit local standards. Thus for a
U.S. firm, date might appear on a report in the form <em>mm/dd/yy</em>; for a
European firm following the ISO standard, date would appear as
<em>yyyy-mm-dd</em>.</p>
<p>SQL-99 introduced the INTERVAL data type, which is a single value
expressed in some unit or units of time (e.g., 6 years, 5 days, 7
hours).</p>
</div>
<div id="blob-binary-large-object" class="section level3 unnumbered">
<h3>BLOB (binary large object)</h3>
<p>BLOB is a large-object data type that stores any kind of binary data.
Binary data typically consists of a saved spreadsheet, graph, audio
file, satellite image, voice pattern, or any digitized data. The BLOB
data type has no maximum size.</p>
</div>
<div id="clob-character-large-object" class="section level3 unnumbered">
<h3>CLOB (character large object)</h3>
<p>CLOB is a large-object data type that stores any kind of character data.
Text data typically consists of reports, correspondence, chapters of a
manual, or contracts. The CLOB data type has no maximum size.</p>
<blockquote>
<p>❓<em>Skill builder</em></p>
<p>What data types would you recommend for the following?</p>
<ol style="list-style-type: decimal">
<li><p>A book’s ISBN</p></li>
<li><p>A photo of a product</p></li>
<li><p>The speed of light (2.9979 × 10<sup>8</sup> meters per second)</p></li>
<li><p>A short description of an animal’s habitat</p></li>
<li><p>The title of a Japanese book</p></li>
<li><p>A legal contract</p></li>
<li><p>The status of an electrical switch</p></li>
<li><p>The date and time a reservation was made</p></li>
<li><p>An item’s value in euros</p></li>
<li><p>The number of children in a family</p></li>
</ol>
</blockquote>
</div>
</div>
<div id="collation-sequence" class="section level2 unnumbered">
<h2>Collation sequence</h2>
<p>A DBMS will typically support many character sets. so it can handle text
in different languages. While many European languages are based on an
alphabet, they do not all use the same alphabet. For example, Norwegian
has some additional characters (e.g., æ ,ø, å) compared to English, and
French accents some letters (e.g., é, ü, and ȃ), which do not occur in
English. Alphabet based languages have a collating sequence, which
defines how to sort individual characters in a particular language. For
English, it is the familiar A B C … X Y Z. Norwegian’s collating
sequence includes three additional symbols, and the sequence is A B C
… X Y Z Æ Ø Å. When you define a database you need to define its
collating sequence. Thus, a database being set up for exclusive use in
Chile would opt for a Spanish collating sequence. You can specify a
collation sequence at the database, table, and, column level. The usual
practice is to specify at the database level.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb135-1"><a href="sql.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> ClassicModels COLLATE latin1_general_cs;</span></code></pre></div>
<p>The latin1_general character set is suitable for Western European
languages. The cs suffix indicates that comparisons are <strong>case
sensitive</strong>. In other words, a query will see the two strings ‘abc’ and
‘Abc’ as different, whereas if case sensitivity is turned off, the
strings are considered identical. Case sensitivity is usually the right
choice to ensure precision of querying.</p>
</div>
<div id="scalar-functions" class="section level2 unnumbered">
<h2>Scalar functions</h2>
<p>Most implementations of SQL include functions that can be used in
arithmetic expressions, and for data conversion or data extraction. The
following sampling of these functions will give you an idea of what is
available. You will need to consult the documentation for your version
of SQL to determine the functions it supports. For example, Microsoft
SQL Server has more than 100 additional functions.</p>
<p><em>Some examples of SQL’s built-in scalar functions</em></p>
<table style="width:99%;">
<colgroup>
<col width="31%" />
<col width="66%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CURRENT_DATE()</td>
<td align="left">Retrieves the current date</td>
</tr>
<tr class="even">
<td align="left">EX
TRACT(date_time_part
FROM expression)</td>
<td align="left">Retrieves part of a time or date (e.g., YEAR,
MONTH, DAY, HOUR, MINUTE, or SECOND)</td>
</tr>
<tr class="odd">
<td align="left">SUBSTRING(str, pos,
len)</td>
<td align="left">Retrieves a string of length <em>len</em> starting
at position pos from string <em>str</em></td>
</tr>
</tbody>
</table>
<p>Some examples:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb136-1"><a href="sql.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">extract</span>(<span class="dt">day</span> <span class="kw">FROM</span> <span class="fu">CURRENT_DATE</span>());</span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb137-1"><a href="sql.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> SUBSTRING(`person first`, <span class="dv">1</span>,<span class="dv">1</span>), `person last` <span class="kw">FROM</span> person;</span></code></pre></div>
<p>A vendor’s additional functions can be very useful. Remember, though,
that use of a vendor’s extensions might limit portability.</p>
<p><em>How many days’ sales are stored in the sale table?</em></p>
<p>This sounds like a simple query, but you have to do a self-join and also
know that there is a function, DATEDIFF, to determine the number of days
between any two dates. Consult your DBMS manual to learn about other
functions for dealing with dates and times.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb138-1"><a href="sql.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span></span>
<span id="cb138-2"><a href="sql.html#cb138-2" aria-hidden="true" tabindex="-1"></a>late <span class="kw">AS</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> sale), </span>
<span id="cb138-3"><a href="sql.html#cb138-3" aria-hidden="true" tabindex="-1"></a>early <span class="kw">AS</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> sale) </span>
<span id="cb138-4"><a href="sql.html#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> DATEDIFF(late.saledate,early.saledate) <span class="kw">AS</span> Difference</span>
<span id="cb138-5"><a href="sql.html#cb138-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> late <span class="kw">JOIN</span> early</span>
<span id="cb138-6"><a href="sql.html#cb138-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> late.saledate <span class="op">=</span> </span>
<span id="cb138-7"><a href="sql.html#cb138-7" aria-hidden="true" tabindex="-1"></a>            (<span class="kw">SELECT</span> <span class="fu">MAX</span>(saledate) <span class="kw">FROM</span> sale)</span>
<span id="cb138-8"><a href="sql.html#cb138-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> early.saledate <span class="op">=</span> </span>
<span id="cb138-9"><a href="sql.html#cb138-9" aria-hidden="true" tabindex="-1"></a>            (<span class="kw">SELECT</span> <span class="fu">MIN</span>(saledate) <span class="kw">FROM</span> sale);</span></code></pre></div>
<p>The preceding query is based on the idea of joining <code>sale</code> with a copy
of itself. The matching column from <code>late</code> is the latest sale’s date (or
MAX), and the matching column from <code>early</code> is the earliest sale’s date
(or MIN). As a result of the join, each row of the new table has both
the earliest and latest dates.</p>
</div>
<div id="formatting" class="section level2 unnumbered">
<h2>Formatting</h2>
<p>You will likely have noticed that some queries report numeric values
with a varying number of decimal places. The FORMAT function gives you
control over the number of decimal places reported, as illustrated in
the following example where yield is reported with two decimal places.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb139-1"><a href="sql.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> shrfirm, shrprice, shrqty, FORMAT(shrdiv<span class="op">/</span>shrprice<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>) <span class="kw">AS</span> yield </span>
<span id="cb139-2"><a href="sql.html#cb139-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> <span class="kw">share</span>;</span></code></pre></div>
<p>When you use format you create a string, but you often want to sort on
the numeric value of the formatted field. The following example
illustrates how to do this.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb140-1"><a href="sql.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> shrfirm, shrprice, shrqty, FORMAT(shrdiv<span class="op">/</span>shrprice<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>) <span class="kw">AS</span> yield <span class="kw">FROM</span> <span class="kw">SHARE</span></span>
<span id="cb140-2"><a href="sql.html#cb140-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ORDER</span> <span class="kw">BY</span> shrdiv<span class="op">/</span>shrprice<span class="op">*</span><span class="dv">100</span> <span class="kw">DESC</span></span></code></pre></div>
<p>To see the difference, run the following code</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb141-1"><a href="sql.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> shrfirm, shrprice, shrqty, FORMAT(shrdiv<span class="op">/</span>shrprice<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>) <span class="kw">AS</span> yield <span class="kw">FROM</span> <span class="kw">SHARE</span></span>
<span id="cb141-2"><a href="sql.html#cb141-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ORDER</span> <span class="kw">BY</span> yield <span class="kw">DESC</span></span></code></pre></div>
</div>
<div id="altering-a-table" class="section level2 unnumbered">
<h2>Altering a table</h2>
<p>The ALTER TABLE statement has two purposes. <em>First,</em> it can add a single
column to an existing table. <em>Second</em>, it can add, drop, activate, or
deactivate primary and foreign key constraints. A base table can be
altered by adding one new column, which appears to the right of existing
columns. The format of the command is</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb142-1"><a href="sql.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> base<span class="op">-</span><span class="kw">table</span> <span class="kw">ADD</span> <span class="kw">column</span> <span class="kw">data</span><span class="op">-</span><span class="kw">type</span>;</span></code></pre></div>
<p>Notice that there is no optional NOT NULL clause for column-definition
with ALTER TABLE. It is not allowed because the ALTER TABLE statement
automatically fills the additional column with null in every case. If
you want to add multiple columns, you repeat the command. ALTER TABLE
does not permit changing the width of a column or amending a column’s
data type. It can be used for deleting an unwanted column.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb143-1"><a href="sql.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> stock <span class="kw">ADD</span> stkrating <span class="dt">CHAR</span>(<span class="dv">3</span>);</span></code></pre></div>
<p>ALTER TABLE is also used to change the status of referential
constraints. You can deactivate constraints on a table’s primary key or
any of its foreign keys. Deactivation also makes the relevant tables
unavailable to all users except the table’s owner or someone possessing
database management authority. After the data are loaded, referential
constraints must be reactivated before they can be automatically
enforced again. Activating the constraints enables the DBMS to validate
the references in the data.</p>
</div>
<div id="dropping-a-table" class="section level2 unnumbered">
<h2>Dropping a table</h2>
<p>A base table can be deleted at any time by using the DROP statement. The
format is</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb144-1"><a href="sql.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> base<span class="op">-</span><span class="kw">table</span>;</span></code></pre></div>
<p>The table is deleted, and any views or indexes defined on the table are
also deleted.</p>
</div>
<div id="creating-a-view" class="section level2 unnumbered">
<h2>Creating a view</h2>
<p>A view is a virtual table. It has no physical counterpart but appears to
the client as if it really exists. A view is defined in terms of other
tables that exist in the database. The syntax is</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb145-1"><a href="sql.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">VIEW</span> <span class="kw">view</span> [<span class="kw">column</span> [,<span class="kw">column</span>] …)]</span>
<span id="cb145-2"><a href="sql.html#cb145-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AS</span> subquery;</span></code></pre></div>
<p>There are several reasons for creating a view. <em>First<strong>,</strong></em> a view can
be used to restrict access to certain rows or columns. This is
particularly important for sensitive data. An organization’s person
table can contain both private data (e.g., annual salary) and public
data (e.g., office phone number). A view consisting of public data
(e.g., person’s name, department, and office telephone number) might be
provided to many people. Access to all columns in the table, however,
might be confined to a small number of people. Here is a sample view
that restricts access to a table.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb146-1"><a href="sql.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">VIEW</span> stklist</span>
<span id="cb146-2"><a href="sql.html#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AS</span> <span class="kw">SELECT</span> stkfirm, stkprice <span class="kw">FROM</span> stock;</span></code></pre></div>
<p>Handling derived data is a second reason for creating a view. A column
that can be computed from one or more other columns should always be
defined by a view. Thus, a stock’s yield would be computed by a view
rather than defined as a column in a base table.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb147-1"><a href="sql.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">VIEW</span> stk </span>
<span id="cb147-2"><a href="sql.html#cb147-2" aria-hidden="true" tabindex="-1"></a>    (stkfirm, stkprice, stkqty, stkyield)</span>
<span id="cb147-3"><a href="sql.html#cb147-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AS</span> <span class="kw">SELECT</span> stkfirm, stkprice, stkqty, stkdiv<span class="op">/</span>stkprice<span class="op">*</span><span class="dv">100</span></span>
<span id="cb147-4"><a href="sql.html#cb147-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> stock;</span></code></pre></div>
<p>A <em>third</em> reason for defining a view is to avoid writing common SQL
queries. For example, there may be some joins that are frequently part
of an SQL query. Productivity can be increased by defining these joins
as views. Here is an example:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb148-1"><a href="sql.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">VIEW</span> stkvalue</span>
<span id="cb148-2"><a href="sql.html#cb148-2" aria-hidden="true" tabindex="-1"></a>    (nation, firm, price, qty, <span class="fu">value</span>)</span>
<span id="cb148-3"><a href="sql.html#cb148-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AS</span> <span class="kw">SELECT</span> natname, stkfirm, stkprice<span class="op">*</span>exchrate, stkqty,</span>
<span id="cb148-4"><a href="sql.html#cb148-4" aria-hidden="true" tabindex="-1"></a>        stkprice<span class="op">*</span>exchrate<span class="op">*</span>stkqty <span class="kw">FROM</span> stock <span class="kw">JOIN</span> nation</span>
<span id="cb148-5"><a href="sql.html#cb148-5" aria-hidden="true" tabindex="-1"></a>            <span class="kw">ON</span> stock.natcode <span class="op">=</span> nation.natcode;</span></code></pre></div>
<p>The preceding example demonstrates how CREATE VIEW can be used to rename
columns, create new columns, and involve more than one table. The column
<code>nation</code> corresponds to <code>natname</code>, <code>firm</code> to <code>stkfirm</code>, and so forth. A
new column, <code>price</code>, is created that converts all share prices from the
local currency to British pounds.</p>
<p>Data conversion is a <em>fourth</em> useful reason for a view. The United
States is one of the few countries that does not use the metric system,
and reports for American managers often display weights and measures in
pounds and feet, respectively. The database of an international company
could record all measurements in metric format (e.g., weight in
kilograms) and use a view to convert these measures for American
reports.</p>
<p>When a CREATE VIEW statement is executed, the definition of the view is
entered in the systems catalog. The subquery following AS, the view
definition, is executed only when the view is referenced in an SQL
command. For example, the following command would enable the subquery to
be executed and the view created:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb149-1"><a href="sql.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> stkvalue <span class="kw">WHERE</span> price <span class="op">&gt;</span> <span class="dv">10</span>;</span></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb150-1"><a href="sql.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> natname, stkfirm, stkprice<span class="op">*</span>exchrate, stkqty, stkprice<span class="op">*</span>exchrate<span class="op">*</span>stkqty</span>
<span id="cb150-2"><a href="sql.html#cb150-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> stock <span class="kw">JOIN</span> nation</span>
<span id="cb150-3"><a href="sql.html#cb150-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> stock.natcode <span class="op">=</span> nation.natcode</span>
<span id="cb150-4"><a href="sql.html#cb150-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> stkprice<span class="op">*</span>exchrate <span class="op">&gt;</span> <span class="dv">10</span>;</span></code></pre></div>
<p>Any table that can be defined with a SELECT statement is a potential
view. Thus, it is possible to have a view that is defined by another
view.</p>
</div>
<div id="dropping-a-view" class="section level2 unnumbered">
<h2>Dropping a view</h2>
<p>DROP VIEW is used to delete a view from the system catalog. A view might
be dropped because it needs to be redefined or is no longer used. It
must be dropped first before a revised version of the view is created.
The syntax is</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb151-1"><a href="sql.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">VIEW</span> <span class="kw">view</span>;</span></code></pre></div>
<p>Remember, if a base table is dropped, all views based on that table are
also dropped.</p>
</div>
<div id="creating-an-index" class="section level2 unnumbered">
<h2>Creating an index</h2>
<p>An index helps speed up retrieval (a more detailed discussion of
indexing is covered later in this book). A column that is frequently
referred to in a WHERE clause is a possible candidate for indexing. For
example, if data on stocks were frequently retrieved using <code>stkfirm</code>,
then this column should be considered for an index. The format for
CREATE INDEX is</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb152-1"><a href="sql.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> [<span class="kw">UNIQUE</span>] <span class="kw">INDEX</span> indexname</span>
<span id="cb152-2"><a href="sql.html#cb152-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> base<span class="op">-</span><span class="kw">table</span> (<span class="kw">column</span> [<span class="kw">order</span>] [,<span class="kw">column</span>, [<span class="kw">order</span>]] …)</span>
<span id="cb152-3"><a href="sql.html#cb152-3" aria-hidden="true" tabindex="-1"></a>    [<span class="kw">CLUSTER</span>];</span></code></pre></div>
<p>This next example illustrates use of CREATE INDEX.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb153-1"><a href="sql.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">UNIQUE</span> <span class="kw">INDEX</span> stkfirmindx <span class="kw">ON</span> stock(stkfirm);</span></code></pre></div>
<p>In the preceding example, an index called <code>stkfirmindx</code> is created for
the table <code>stock</code>. Index entries are ordered by ascending (the default
order) values of <code>stkfirm</code>. The optional clause UNIQUE specifies that no
two rows in the base table can have the same value for <code>stkfirm</code>, the
indexed column. Specifying UNIQUE means that the DBMS will reject any
insert or update operation that would create a duplicate value for
<code>stkfirm</code>.</p>
<p>A composite index can be created from several columns, which is often
necessary for an associative entity. The following example illustrates
the creation of a composite index.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb154-1"><a href="sql.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> lineitemindx <span class="kw">ON</span> lineitem (lineno, saleno);</span></code></pre></div>
</div>
<div id="dropping-an-index" class="section level2 unnumbered">
<h2>Dropping an index</h2>
<p>Indexes can be dropped at any time by using the DROP INDEX statement.
The general form of this statement is</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb155-1"><a href="sql.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">INDEX</span> <span class="kw">index</span>;</span></code></pre></div>
</div>
<div id="data-manipulation" class="section level2 unnumbered">
<h2>Data manipulation</h2>
<p>SQL supports four DML statements—SELECT, INSERT, UPDATE, and DELETE.
Each of these will be discussed in turn, with most attention focusing on
SELECT because of the variety of ways in which it can be used. First, we
need to understand why we must qualify column names and temporary names.</p>
</div>
<div id="qualifying-column-names" class="section level2 unnumbered">
<h2>Qualifying column names</h2>
<p>Ambiguous references to column names are avoided by qualifying a column
name with its table name, especially when the same column name is used
in several tables. Clarity is maintained by prefixing the column name
with the table name. The following example demonstrates qualification of
the <code>natcode</code>, which appears in both <code>stock</code> and <code>nation</code>.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb156-1"><a href="sql.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> stkfirm, stkprice <span class="kw">FROM</span> stock <span class="kw">JOIN</span> nation</span>
<span id="cb156-2"><a href="sql.html#cb156-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> stock.natcode <span class="op">=</span> nation.natcode;</span></code></pre></div>
</div>
<div id="temporary-names" class="section level2 unnumbered">
<h2>Temporary names</h2>
<p>Using the WITH clause, a table or view can be given a temporary name, or
alias, that remains current for a query. Temporary names are used in a
self-join to distinguish the copies of the table.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb157-1"><a href="sql.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span></span>
<span id="cb157-2"><a href="sql.html#cb157-2" aria-hidden="true" tabindex="-1"></a>wrk <span class="kw">AS</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> emp), </span>
<span id="cb157-3"><a href="sql.html#cb157-3" aria-hidden="true" tabindex="-1"></a>boss <span class="kw">AS</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> emp) </span>
<span id="cb157-4"><a href="sql.html#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> wrk.empfname</span>
<span id="cb157-5"><a href="sql.html#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> wrk <span class="kw">JOIN</span> boss</span>
<span id="cb157-6"><a href="sql.html#cb157-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> wrk.bossno <span class="op">=</span> boss.empno;</span></code></pre></div>
<p>A temporary name also can be used as a shortened form of a long table
name. For example, l might be used merely to avoid having to enter
<code>lineitem</code> more than once. If a temporary name is specified for a table
or view, any qualified reference to a column of the table or view must
also use that temporary name.</p>
</div>
<div id="select" class="section level2 unnumbered">
<h2>SELECT</h2>
<p>The SELECT statement is by far the most interesting and challenging of
the four DML statements. It reveals a major benefit of the relational
model: powerful interrogation capabilities. It is challenging because
mastering the power of SELECT requires considerable practice with a wide
range of queries. The major varieties of SELECT are presented in this
section. The SQL Playbook, which follows this chapter, reveals the full
power of the command.</p>
<p>The general format of SELECT is</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb158-1"><a href="sql.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> [<span class="kw">DISTINCT</span>] item(s) <span class="kw">FROM</span> <span class="kw">table</span>(s)</span>
<span id="cb158-2"><a href="sql.html#cb158-2" aria-hidden="true" tabindex="-1"></a>    [<span class="kw">WHERE</span> condition]</span>
<span id="cb158-3"><a href="sql.html#cb158-3" aria-hidden="true" tabindex="-1"></a>    [<span class="kw">GROUP</span> <span class="kw">BY</span> <span class="kw">column</span>(s)] [<span class="kw">HAVING</span> condition]</span>
<span id="cb158-4"><a href="sql.html#cb158-4" aria-hidden="true" tabindex="-1"></a>    [<span class="kw">ORDER</span> <span class="kw">BY</span> <span class="kw">column</span>(s)];</span></code></pre></div>
<p>Alternatively, we can diagram the structure of SELECT.</p>
<p><em>Structure of SELECT</em></p>
<p><img src="Figures/Chapter%2010/select%20structure.png" /></p>
<div id="product-1" class="section level3 unnumbered">
<h3>Product</h3>
<p>Product, or more strictly Cartesian product, is a fundamental operation
of relational algebra. It is rarely used by itself in a query; however,
understanding its effect helps in comprehending join. The product of two
tables is a new table consisting of all rows of the first table
concatenated with all possible rows of the second table. For example:</p>
<p><em>Form the product of stock and nation.</em></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb159-1"><a href="sql.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> stock, nation;</span></code></pre></div>
<p>The new table contains 64 rows (16*4), where <code>stock</code> has 16 rows and
<code>nation</code> has 4 rows. It has 10 columns (7 + 3), where <code>stock</code> has 7
columns and <code>nation</code> has 3 columns. The result of the operation is shown
in the following table. Note that each row in <code>stock</code> is concatenated
with each row in <code>nation</code>.</p>
<p><em>Product of stock and nation</em></p>
<table>
<thead>
<tr class="header">
<th align="left">stkcode</th>
<th align="left">stkfirm</th>
<th align="right">stkprice</th>
<th align="right">stkqty</th>
<th align="right">stkdiv</th>
<th align="right">stkpe</th>
<th align="left">natcode</th>
<th align="left">natcode</th>
<th align="left">natname</th>
<th align="right">exchrate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FC</td>
<td align="left">Freedonia Copper</td>
<td align="right">27.5</td>
<td align="right">10529</td>
<td align="right">1.84</td>
<td align="right">16</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">FC</td>
<td align="left">Freedonia Copper</td>
<td align="right">27.5</td>
<td align="right">10529</td>
<td align="right">1.84</td>
<td align="right">16</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">FC</td>
<td align="left">Freedonia Copper</td>
<td align="right">27.5</td>
<td align="right">10529</td>
<td align="right">1.84</td>
<td align="right">16</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">FC</td>
<td align="left">Freedonia Copper</td>
<td align="right">27.5</td>
<td align="right">10529</td>
<td align="right">1.84</td>
<td align="right">16</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">PT</td>
<td align="left">Patagonian Tea</td>
<td align="right">55.25</td>
<td align="right">12635</td>
<td align="right">2.5</td>
<td align="right">10</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">PT</td>
<td align="left">Patagonian Tea</td>
<td align="right">55.25</td>
<td align="right">12635</td>
<td align="right">2.5</td>
<td align="right">10</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">PT</td>
<td align="left">Patagonian Tea</td>
<td align="right">55.25</td>
<td align="right">12635</td>
<td align="right">2.5</td>
<td align="right">10</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">PT</td>
<td align="left">Patagonian Tea</td>
<td align="right">55.25</td>
<td align="right">12635</td>
<td align="right">2.5</td>
<td align="right">10</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">AR</td>
<td align="left">Abyssinian Ruby</td>
<td align="right">31.82</td>
<td align="right">22010</td>
<td align="right">1.32</td>
<td align="right">13</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">AR</td>
<td align="left">Abyssinian Ruby</td>
<td align="right">31.82</td>
<td align="right">22010</td>
<td align="right">1.32</td>
<td align="right">13</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">AR</td>
<td align="left">Abyssinian Ruby</td>
<td align="right">31.82</td>
<td align="right">22010</td>
<td align="right">1.32</td>
<td align="right">13</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">AR</td>
<td align="left">Abyssinian Ruby</td>
<td align="right">31.82</td>
<td align="right">22010</td>
<td align="right">1.32</td>
<td align="right">13</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">SLG</td>
<td align="left">Sri Lankan Gold</td>
<td align="right">50.37</td>
<td align="right">32868</td>
<td align="right">2.68</td>
<td align="right">16</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">SLG</td>
<td align="left">Sri Lankan Gold</td>
<td align="right">50.37</td>
<td align="right">32868</td>
<td align="right">2.68</td>
<td align="right">16</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">SLG</td>
<td align="left">Sri Lankan Gold</td>
<td align="right">50.37</td>
<td align="right">32868</td>
<td align="right">2.68</td>
<td align="right">16</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">SLG</td>
<td align="left">Sri Lankan Gold</td>
<td align="right">50.37</td>
<td align="right">32868</td>
<td align="right">2.68</td>
<td align="right">16</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">ILZ</td>
<td align="left">Indian Lead &amp; Zinc</td>
<td align="right">37.75</td>
<td align="right">6390</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">ILZ</td>
<td align="left">Indian Lead &amp; Zinc</td>
<td align="right">37.75</td>
<td align="right">6390</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">ILZ</td>
<td align="left">Indian Lead &amp; Zinc</td>
<td align="right">37.75</td>
<td align="right">6390</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">ILZ</td>
<td align="left">Indian Lead &amp; Zinc</td>
<td align="right">37.75</td>
<td align="right">6390</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">BE</td>
<td align="left">Burmese Elephant</td>
<td align="right">0.07</td>
<td align="right">154713</td>
<td align="right">0.01</td>
<td align="right">3</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">BE</td>
<td align="left">Burmese Elephant</td>
<td align="right">0.07</td>
<td align="right">154713</td>
<td align="right">0.01</td>
<td align="right">3</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">BE</td>
<td align="left">Burmese Elephant</td>
<td align="right">0.07</td>
<td align="right">154713</td>
<td align="right">0.01</td>
<td align="right">3</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">BE</td>
<td align="left">Burmese Elephant</td>
<td align="right">0.07</td>
<td align="right">154713</td>
<td align="right">0.01</td>
<td align="right">3</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">BS</td>
<td align="left">Bolivian Sheep</td>
<td align="right">12.75</td>
<td align="right">231678</td>
<td align="right">1.78</td>
<td align="right">11</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">BS</td>
<td align="left">Bolivian Sheep</td>
<td align="right">12.75</td>
<td align="right">231678</td>
<td align="right">1.78</td>
<td align="right">11</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">BS</td>
<td align="left">Bolivian Sheep</td>
<td align="right">12.75</td>
<td align="right">231678</td>
<td align="right">1.78</td>
<td align="right">11</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">BS</td>
<td align="left">Bolivian Sheep</td>
<td align="right">12.75</td>
<td align="right">231678</td>
<td align="right">1.78</td>
<td align="right">11</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">NG</td>
<td align="left">Nigerian Geese</td>
<td align="right">35</td>
<td align="right">12323</td>
<td align="right">1.68</td>
<td align="right">10</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">NG</td>
<td align="left">Nigerian Geese</td>
<td align="right">35</td>
<td align="right">12323</td>
<td align="right">1.68</td>
<td align="right">10</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">NG</td>
<td align="left">Nigerian Geese</td>
<td align="right">35</td>
<td align="right">12323</td>
<td align="right">1.68</td>
<td align="right">10</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">NG</td>
<td align="left">Nigerian Geese</td>
<td align="right">35</td>
<td align="right">12323</td>
<td align="right">1.68</td>
<td align="right">10</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">CS</td>
<td align="left">Canadian Sugar</td>
<td align="right">52.78</td>
<td align="right">4716</td>
<td align="right">2.5</td>
<td align="right">15</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">CS</td>
<td align="left">Canadian Sugar</td>
<td align="right">52.78</td>
<td align="right">4716</td>
<td align="right">2.5</td>
<td align="right">15</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">CS</td>
<td align="left">Canadian Sugar</td>
<td align="right">52.78</td>
<td align="right">4716</td>
<td align="right">2.5</td>
<td align="right">15</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">CS</td>
<td align="left">Canadian Sugar</td>
<td align="right">52.78</td>
<td align="right">4716</td>
<td align="right">2.5</td>
<td align="right">15</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">ROF</td>
<td align="left">Royal Ostrich Farms</td>
<td align="right">33.75</td>
<td align="right">1234923</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="left">UK</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">ROF</td>
<td align="left">Royal Ostrich Farms</td>
<td align="right">33.75</td>
<td align="right">1234923</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="left">UK</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">ROF</td>
<td align="left">Royal Ostrich Farms</td>
<td align="right">33.75</td>
<td align="right">1234923</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="left">UK</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">ROF</td>
<td align="left">Royal Ostrich Farms</td>
<td align="right">33.75</td>
<td align="right">1234923</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="left">UK</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">MG</td>
<td align="left">Minnesota Gold</td>
<td align="right">53.87</td>
<td align="right">816122</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="left">US</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">MG</td>
<td align="left">Minnesota Gold</td>
<td align="right">53.87</td>
<td align="right">816122</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="left">US</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">MG</td>
<td align="left">Minnesota Gold</td>
<td align="right">53.87</td>
<td align="right">816122</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="left">US</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">MG</td>
<td align="left">Minnesota Gold</td>
<td align="right">53.87</td>
<td align="right">816122</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="left">US</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">GP</td>
<td align="left">Georgia Peach</td>
<td align="right">2.35</td>
<td align="right">387333</td>
<td align="right">0.2</td>
<td align="right">5</td>
<td align="left">US</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">GP</td>
<td align="left">Georgia Peach</td>
<td align="right">2.35</td>
<td align="right">387333</td>
<td align="right">0.2</td>
<td align="right">5</td>
<td align="left">US</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">GP</td>
<td align="left">Georgia Peach</td>
<td align="right">2.35</td>
<td align="right">387333</td>
<td align="right">0.2</td>
<td align="right">5</td>
<td align="left">US</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">GP</td>
<td align="left">Georgia Peach</td>
<td align="right">2.35</td>
<td align="right">387333</td>
<td align="right">0.2</td>
<td align="right">5</td>
<td align="left">US</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">NE</td>
<td align="left">Narembeen Emu</td>
<td align="right">12.34</td>
<td align="right">45619</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="left">AUS</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">NE</td>
<td align="left">Narembeen Emu</td>
<td align="right">12.34</td>
<td align="right">45619</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="left">AUS</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">NE</td>
<td align="left">Narembeen Emu</td>
<td align="right">12.34</td>
<td align="right">45619</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="left">AUS</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">NE</td>
<td align="left">Narembeen Emu</td>
<td align="right">12.34</td>
<td align="right">45619</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="left">AUS</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">QD</td>
<td align="left">Queensland Diamond</td>
<td align="right">6.73</td>
<td align="right">89251</td>
<td align="right">0.5</td>
<td align="right">7</td>
<td align="left">AUS</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">QD</td>
<td align="left">Queensland Diamond</td>
<td align="right">6.73</td>
<td align="right">89251</td>
<td align="right">0.5</td>
<td align="right">7</td>
<td align="left">AUS</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">QD</td>
<td align="left">Queensland Diamond</td>
<td align="right">6.73</td>
<td align="right">89251</td>
<td align="right">0.5</td>
<td align="right">7</td>
<td align="left">AUS</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">QD</td>
<td align="left">Queensland Diamond</td>
<td align="right">6.73</td>
<td align="right">89251</td>
<td align="right">0.5</td>
<td align="right">7</td>
<td align="left">AUS</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">IR</td>
<td align="left">Indooroopilly Ruby</td>
<td align="right">15.92</td>
<td align="right">56147</td>
<td align="right">0.5</td>
<td align="right">20</td>
<td align="left">AUS</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">IR</td>
<td align="left">Indooroopilly Ruby</td>
<td align="right">15.92</td>
<td align="right">56147</td>
<td align="right">0.5</td>
<td align="right">20</td>
<td align="left">AUS</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">IR</td>
<td align="left">Indooroopilly Ruby</td>
<td align="right">15.92</td>
<td align="right">56147</td>
<td align="right">0.5</td>
<td align="right">20</td>
<td align="left">AUS</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">IR</td>
<td align="left">Indooroopilly Ruby</td>
<td align="right">15.92</td>
<td align="right">56147</td>
<td align="right">0.5</td>
<td align="right">20</td>
<td align="left">AUS</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
<tr class="odd">
<td align="left">BD</td>
<td align="left">Bombay Duck</td>
<td align="right">25.55</td>
<td align="right">167382</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="left">IND</td>
<td align="left">UK</td>
<td align="left">United Kingdom</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td align="left">BD</td>
<td align="left">Bombay Duck</td>
<td align="right">25.55</td>
<td align="right">167382</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="left">IND</td>
<td align="left">US</td>
<td align="left">United States</td>
<td align="right">0.6700</td>
</tr>
<tr class="odd">
<td align="left">BD</td>
<td align="left">Bombay Duck</td>
<td align="right">25.55</td>
<td align="right">167382</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="left">IND</td>
<td align="left">AUS</td>
<td align="left">Australia</td>
<td align="right">0.4600</td>
</tr>
<tr class="even">
<td align="left">BD</td>
<td align="left">Bombay Duck</td>
<td align="right">25.55</td>
<td align="right">167382</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="left">IND</td>
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">0.0228</td>
</tr>
</tbody>
</table>
<p><em>Find the percentage of Australian stocks in the portfolio.</em></p>
<p>To answer this query, you need to count the number of Australian stocks,
count the total number of stocks in the portfolio, and then compute the
percentage. Computing each of the totals is a straightforward
application of count. If we save the results of the two counts as views,
then we have the necessary data to compute the percentage. The two views
each consist of a single-cell table (i.e., one row and one column). We
create the product of these two views to get the data needed for
computing the percentage in one row. The SQL is</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb160-1"><a href="sql.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">VIEW</span> austotal (auscount) <span class="kw">AS</span></span>
<span id="cb160-2"><a href="sql.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">FROM</span> nation <span class="kw">JOIN</span> stock</span>
<span id="cb160-3"><a href="sql.html#cb160-3" aria-hidden="true" tabindex="-1"></a>     <span class="kw">ON</span> natname <span class="op">=</span> <span class="st">&#39;Australia&#39;</span></span>
<span id="cb160-4"><a href="sql.html#cb160-4" aria-hidden="true" tabindex="-1"></a>     <span class="kw">WHERE</span> nation.natcode <span class="op">=</span> stock.natcode;</span></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb161-1"><a href="sql.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">VIEW</span> total (totalcount) <span class="kw">AS</span></span>
<span id="cb161-2"><a href="sql.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">FROM</span> stock;</span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb162-1"><a href="sql.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> auscount<span class="op">/</span>totalcount<span class="op">*</span><span class="dv">100</span></span>
<span id="cb162-2"><a href="sql.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AS</span> percentage <span class="kw">FROM</span> austotal, total;</span></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb163-1"><a href="sql.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">VIEW</span> total (totalcount) <span class="kw">AS</span></span>
<span id="cb163-2"><a href="sql.html#cb163-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">FROM</span> stock;</span></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb164-1"><a href="sql.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> auscount<span class="op">*</span><span class="dv">100</span><span class="op">/</span>totalcount <span class="kw">as</span> Percentage </span>
<span id="cb164-2"><a href="sql.html#cb164-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> austotal, total;</span></code></pre></div>
<p>The result of a COUNT is always an integer, and SQL will typically
create an integer data type in which to store the results. When two
variables have a data type of integer, SQL will likely use integer
arithmetic for all computations, and all results will be integer. To get
around the issue of integer arithmetic, we first multiply the number of
Australian stocks by 100 before dividing by the total number of stocks.
Because of integer arithmetic, you might get a different answer if you
used the following SQL.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb165-1"><a href="sql.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> auscount<span class="op">/</span>totalcount<span class="op">*</span><span class="dv">100</span> <span class="kw">as</span> Percentage </span>
<span id="cb165-2"><a href="sql.html#cb165-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> austotal, total;</span></code></pre></div>
<p>The preceding example was used to show when you might find product
useful. You can also write the query as</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb166-1"><a href="sql.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">FROM</span> stock <span class="kw">WHERE</span> natcode <span class="op">=</span> <span class="st">&#39;AUS&#39;</span>)<span class="op">*</span><span class="dv">100</span><span class="op">/</span></span>
<span id="cb166-2"><a href="sql.html#cb166-2" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">FROM</span> stock) <span class="kw">as</span> Percentage;</span></code></pre></div>
</div>
<div id="inner-join" class="section level3 unnumbered">
<h3>Inner join</h3>
<p>Inner join, often referred to as join, is a powerful and frequently used
operation. It creates a new table from two existing tables by matching
on a column common to both tables. An <strong>equijoin</strong> is the simplest form
of join; in this case, columns are matched on equality.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb167-1"><a href="sql.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> stock <span class="kw">JOIN</span> nation</span>
<span id="cb167-2"><a href="sql.html#cb167-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> stock.natcode <span class="op">=</span> nation.natcode;</span></code></pre></div>
<p>There are other ways of expressing join that are more concise. For
example, we can write</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb168-1"><a href="sql.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> stock <span class="kw">INNER</span> <span class="kw">JOIN</span> nation <span class="kw">USING</span> (natcode);</span></code></pre></div>
<p>The preceding syntax implicitly recognizes the frequent use of the same
column name for matching primary and foreign keys.</p>
<p>A further simplification is to rely on the primary and foreign key
definitions to determine the join condition, so we can write</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb169-1"><a href="sql.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> stock <span class="kw">NATURAL</span> <span class="kw">JOIN</span> nation;</span></code></pre></div>
<p>An equijoin creates a new table that contains two identical columns. If
one of these is dropped, then the remaining table is called a natural
join.</p>
<p>As you now realize, join can be thought of as a product with a condition
clause. There is no reason why this condition needs to be restricted to
equality. There could easily be another comparison operator between the
two columns. This general version is called a theta-join because theta
is a variable that can take any value from the set ‘=’, ‘&lt;’, ‘&lt;=’,
‘&gt;’, and ‘&gt;=’.</p>
<p>As you discovered earlier, there are occasions when you need to join a
table to itself. To do this, make two copies of the table first and give
each of these copies a unique name.</p>
<p><em>Find the names of employees who earn more than their boss.</em></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb170-1"><a href="sql.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> wrk.empfname</span>
<span id="cb170-2"><a href="sql.html#cb170-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> emp wrk <span class="kw">JOIN</span> emp boss</span>
<span id="cb170-3"><a href="sql.html#cb170-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> wrk.bossno <span class="op">=</span> boss.empno</span>
<span id="cb170-4"><a href="sql.html#cb170-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> wrk.empsalary <span class="op">&gt;</span> boss.empsalary;</span></code></pre></div>
</div>
<div id="outer-join" class="section level3 unnumbered">
<h3>Outer join</h3>
<p>A traditional join, more formally known as an inner join, reports those rows where the primary and foreign keys match. An outer join reports these matching rows and others depending on which form is used, as the following examples illustrate for the sample table.</p>
<table>
<thead>
<tr class="header">
<th align="left">t1</th>
<th></th>
<th></th>
<th align="left">t2</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">id</td>
<td>col1</td>
<td></td>
<td align="left">id</td>
<td>col2</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td>a</td>
<td></td>
<td align="left">1</td>
<td>x</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td>b</td>
<td></td>
<td align="left">3</td>
<td>y</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td>c</td>
<td></td>
<td align="left">5</td>
<td>z</td>
</tr>
</tbody>
</table>
<p>A <strong>left outer join</strong> is an inner join plus those rows from t1 not
included in the inner join.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb171-1"><a href="sql.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">id</span>, col1, col2 <span class="kw">FROM</span> t1 <span class="kw">LEFT</span> <span class="kw">JOIN</span> t2 <span class="kw">USING</span> (<span class="kw">id</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">id</th>
<th align="left">col1</th>
<th align="left">col2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">a</td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">b</td>
<td align="left">null</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">c</td>
<td align="left">y</td>
</tr>
</tbody>
</table>
<p>Here is an example to illustrate the use of a left join.</p>
<p><em>For all brown items, report each sale. Include in the report those
brown items that have appeared in no sales.</em></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb172-1"><a href="sql.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> itemname, saleno, lineqty <span class="kw">FROM</span> item</span>
<span id="cb172-2"><a href="sql.html#cb172-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> lineitem <span class="kw">USING</span> (itemno)</span>
<span id="cb172-3"><a href="sql.html#cb172-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> itemcolor <span class="op">=</span> <span class="st">&#39;Brown&#39;</span></span>
<span id="cb172-4"><a href="sql.html#cb172-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ORDER</span> <span class="kw">BY</span> itemname;</span></code></pre></div>
<p>A <strong>right outer join</strong> is an inner join plus those rows from t2 not
included in the inner join.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb173-1"><a href="sql.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">id</span>, col1, col2 <span class="kw">FROM</span> t1 <span class="kw">RIGHT</span> <span class="kw">JOIN</span> t2 <span class="kw">USING</span> (<span class="kw">id</span>);</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Id</th>
<th align="left">col1</th>
<th align="left">col2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">a</td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">c</td>
<td align="left">y</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">null</td>
<td align="left">z</td>
</tr>
</tbody>
</table>
<p>A <strong>full outer join</strong> is an inner join plus those rows from t1 and t2
not included in the inner join.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb174-1"><a href="sql.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">id</span>, col1, col2 <span class="kw">FROM</span> t1 <span class="kw">FULL</span> <span class="kw">JOIN</span> t2 <span class="kw">USING</span> (<span class="kw">id</span>);</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">id</th>
<th align="left">col1</th>
<th align="left">col2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">a</td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">b</td>
<td align="left">null</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">c</td>
<td align="left">y</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">null</td>
<td align="left">z</td>
</tr>
</tbody>
</table>
<p>MySQL does not support a full outer join, rather you must use a union of
a left and right outer joins.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb175-1"><a href="sql.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">id</span>, col1, col2 <span class="kw">FROM</span> t1 <span class="kw">LEFT</span> <span class="kw">JOIN</span> t2 <span class="kw">USING</span> (<span class="kw">id</span>)</span>
<span id="cb175-2"><a href="sql.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span></span>
<span id="cb175-3"><a href="sql.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">id</span>, col1, col2 <span class="kw">FROM</span> t1 <span class="kw">RIGHT</span> <span class="kw">JOIN</span> t2 <span class="kw">USING</span> (<span class="kw">id</span>);</span></code></pre></div>
</div>
<div id="simple-subquery" class="section level3 unnumbered">
<h3>Simple subquery</h3>
<p>A subquery is a query within a query. There is a SELECT statement nested
inside another SELECT statement. Simple subqueries were used extensively
in earlier chapters. For reference, here is a simple subquery used
earlier:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb176-1"><a href="sql.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> stkfirm <span class="kw">FROM</span> stock</span>
<span id="cb176-2"><a href="sql.html#cb176-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> natcode <span class="kw">IN</span></span>
<span id="cb176-3"><a href="sql.html#cb176-3" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">SELECT</span> natcode <span class="kw">FROM</span> nation</span>
<span id="cb176-4"><a href="sql.html#cb176-4" aria-hidden="true" tabindex="-1"></a>            <span class="kw">WHERE</span> natname <span class="op">=</span> <span class="st">&#39;Australia&#39;</span>);</span></code></pre></div>
</div>
<div id="correlated-subquery-1" class="section level3 unnumbered">
<h3>Correlated subquery</h3>
<p>A correlated subquery differs from a simple subquery in that the inner
query must be evaluated more than once. Consider the following example
described previously:</p>
<p><em>Find those stocks where the quantity is greater than the average for
that country.</em></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb177-1"><a href="sql.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> natname, stkfirm, stkqty <span class="kw">FROM</span> stock <span class="kw">JOIN</span> nation</span>
<span id="cb177-2"><a href="sql.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> stock.natcode <span class="op">=</span> nation.natcode</span>
<span id="cb177-3"><a href="sql.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> stkqty <span class="op">&gt;</span> </span>
<span id="cb177-4"><a href="sql.html#cb177-4" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">SELECT</span> <span class="fu">AVG</span>(stkqty) <span class="kw">FROM</span> stock</span>
<span id="cb177-5"><a href="sql.html#cb177-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> stock.natcode <span class="op">=</span> nation.natcode);</span></code></pre></div>
<p>The requirement to compare a column against a function (e.g., average or
count) of some column of specified rows of is usually a clue that you
need to write a correlated subquery. In the preceding example, the stock
quantity for each row is compared with the average stock quantity for
that row’s country.</p>
</div>
<div id="aggregate-functions-1" class="section level3 unnumbered">
<h3>Aggregate functions</h3>
<p>SQL’s aggregate functions increase its retrieval power. These functions
were covered earlier and are only mentioned briefly here for
completeness. The five aggregate functions are shown in the following
table. Nulls in the column are ignored in the case of SUM, AVG, MAX, and
MIN. COUNT(*) does not distinguish between null and non-null values in
a column. Use COUNT(columnname) to exclude a null value in columnname.</p>
<p><em>Aggregate functions</em></p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">COUNT</td>
<td align="left">Counts the number of values in a column</td>
</tr>
<tr class="even">
<td align="left">SUM</td>
<td align="left">Sums the values in a column</td>
</tr>
<tr class="odd">
<td align="left">AVG</td>
<td align="left">Determines the average of the values in a column</td>
</tr>
<tr class="even">
<td align="left">MAX</td>
<td align="left">Determines the largest value in a column</td>
</tr>
<tr class="odd">
<td align="left">MIN</td>
<td align="left">Determines the smallest value in a column</td>
</tr>
</tbody>
</table>
</div>
<div id="group-by-and-having" class="section level3 unnumbered">
<h3>GROUP BY and HAVING</h3>
<p>The GROUP BY clause is an elementary form of control break reporting and
supports grouping of rows that have the same value for a specified
column and produces one row for each different value of the grouping
column. For example,</p>
<p><em>Report by nation the total value of stockholdings.</em></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb178-1"><a href="sql.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> natname, <span class="fu">SUM</span>(stkprice<span class="op">*</span>stkqty<span class="op">*</span>exchrate) <span class="kw">AS</span> total</span>
<span id="cb178-2"><a href="sql.html#cb178-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> stock <span class="kw">JOIN</span> nation <span class="kw">ON</span> stock.natcode <span class="op">=</span> nation.natcode</span>
<span id="cb178-3"><a href="sql.html#cb178-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">GROUP</span> <span class="kw">BY</span> natname;</span></code></pre></div>
<p>The HAVING clause is often associated with GROUP BY. It can be thought
of as the WHERE clause of GROUP BY because it is used to eliminate rows
for a GROUP BY condition. Both GROUP BY and HAVING are dealt with
in-depth in Chapter 4.</p>
</div>
<div id="regexp" class="section level3 unnumbered">
<h3>REGEXP</h3>
<p>The REGEXP clause supports pattern matching to find a defined set of
strings in a character column (CHAR or VARCHAR). Refer to Chapters 3 and
4 for more details.</p>
</div>
</div>
<div id="insert" class="section level2 unnumbered">
<h2>INSERT</h2>
<p>There are two formats for INSERT. The first format is used to insert one
row into a table.</p>
<div id="inserting-a-single-record" class="section level3 unnumbered">
<h3>Inserting a single record</h3>
<p>The general form is</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb179-1"><a href="sql.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> <span class="kw">table</span> [(<span class="kw">column</span> [,<span class="kw">column</span>] …)]</span>
<span id="cb179-2"><a href="sql.html#cb179-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">VALUES</span> (literal [,literal] …);</span></code></pre></div>
<p>For example,</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb180-1"><a href="sql.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> stock</span>
<span id="cb180-2"><a href="sql.html#cb180-2" aria-hidden="true" tabindex="-1"></a>    (stkcode,stkfirm,stkprice,stkqty,stkdiv,stkpe)</span>
<span id="cb180-3"><a href="sql.html#cb180-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">VALUES</span> (<span class="st">&#39;FC&#39;</span>,<span class="st">&#39;Freedonia Copper&#39;</span>,<span class="fl">27.5</span>,<span class="dv">10529</span>,<span class="fl">1.84</span>,<span class="dv">16</span>);</span></code></pre></div>
<p>In this example, <code>stkcode</code> is given the value “FC,” <code>stkfirm</code> is
“Freedonia Copper,” and so on. In general, the <em>n</em>th column in the table
is the <em>n</em>th value in the list.</p>
<p>When the value list refers to all field names in the left-to-right order
in which they appear in the table, then the columns list can be omitted.
So, it is possible to write the following:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb181-1"><a href="sql.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> stock</span>
<span id="cb181-2"><a href="sql.html#cb181-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">VALUES</span> (<span class="st">&#39;FC&#39;</span>,<span class="st">&#39;Freedonia Copper&#39;</span>,<span class="fl">27.5</span>,<span class="dv">10529</span>,<span class="fl">1.84</span>,<span class="dv">16</span>);</span></code></pre></div>
<p>If some values are unknown, then the INSERT can omit these from the
list. Undefined columns will have nulls. For example, if a new stock is
to be added for which the price, dividend, and PE ratio is 5, the
following INSERT statement would be used:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb182-1"><a href="sql.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> stock</span>
<span id="cb182-2"><a href="sql.html#cb182-2" aria-hidden="true" tabindex="-1"></a>    (stkcode, stkfirm, stkqty)</span>
<span id="cb182-3"><a href="sql.html#cb182-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">VALUES</span> (<span class="st">&#39;EE&#39;</span>,<span class="st">&#39;Elysian Emeralds&#39;</span>,<span class="dv">5</span>);</span></code></pre></div>
</div>
<div id="inserting-multiple-records-using-a-query" class="section level3 unnumbered">
<h3>Inserting multiple records using a query</h3>
<p>The second form of INSERT operates in conjunction with a subquery. The
resulting rows are then inserted into a table. Imagine the situation
where stock price information is downloaded from an information service
into a table. This table could contain information about all stocks and
may contain additional columns that are not required for the stock
table. The following INSERT statement could be used:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb183-1"><a href="sql.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> stock</span>
<span id="cb183-2"><a href="sql.html#cb183-2" aria-hidden="true" tabindex="-1"></a>    (stkcode, stkfirm, stkprice, stkdiv, stkpe)</span>
<span id="cb183-3"><a href="sql.html#cb183-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> code, firm, price, div, pe</span>
<span id="cb183-4"><a href="sql.html#cb183-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> download <span class="kw">WHERE</span> code <span class="kw">IN</span></span>
<span id="cb183-5"><a href="sql.html#cb183-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;FC&#39;</span>,<span class="st">&#39;PT&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;SLG&#39;</span>,<span class="st">&#39;ILZ&#39;</span>,<span class="st">&#39;BE&#39;</span>,<span class="st">&#39;BS&#39;</span>,<span class="st">&#39;NG&#39;</span>,<span class="st">&#39;CS&#39;</span>,<span class="st">&#39;ROF&#39;</span>);</span></code></pre></div>
<p>Think of INSERT with a subquery as a way of copying a table. You can
select the rows and columns of a particular table that you want to copy
into an existing or new table.</p>
</div>
</div>
<div id="update-1" class="section level2 unnumbered">
<h2>UPDATE</h2>
<p>The UPDATE command is used to modify values in a table. The general
format is</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb184-1"><a href="sql.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> <span class="kw">table</span></span>
<span id="cb184-2"><a href="sql.html#cb184-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SET</span> <span class="kw">column</span> <span class="op">=</span> scalar expression</span>
<span id="cb184-3"><a href="sql.html#cb184-3" aria-hidden="true" tabindex="-1"></a>        [, <span class="kw">column</span> <span class="op">=</span> scalar expression] …</span>
<span id="cb184-4"><a href="sql.html#cb184-4" aria-hidden="true" tabindex="-1"></a>    [<span class="kw">WHERE</span> condition];</span></code></pre></div>
<p>Permissible scalar expressions involve columns, scalar functions (see
the section on scalar functions in this chapter), or constants. No
aggregate functions are allowable.</p>
<div id="updating-a-single-row" class="section level3 unnumbered">
<h3>Updating a single row</h3>
<p>UPDATE can be used to modify a single row in a table. Suppose you need
to revise your data after 200,000 shares of Minnesota Gold are sold. You
would code the following:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb185-1"><a href="sql.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> stock</span>
<span id="cb185-2"><a href="sql.html#cb185-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SET</span> stkqty <span class="op">=</span> stkqty <span class="op">-</span> <span class="dv">200000</span></span>
<span id="cb185-3"><a href="sql.html#cb185-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> stkcode <span class="op">=</span> <span class="st">&#39;MG&#39;</span>;</span></code></pre></div>
</div>
<div id="updating-multiple-rows" class="section level3 unnumbered">
<h3>Updating multiple rows</h3>
<p>Multiple rows in a table can be updated as well. Imagine the situation
where several stocks change their dividend to £2.50. Then the following
statement could be used:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb186-1"><a href="sql.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> stock</span>
<span id="cb186-2"><a href="sql.html#cb186-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SET</span> stkdiv <span class="op">=</span> <span class="fl">2.50</span></span>
<span id="cb186-3"><a href="sql.html#cb186-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> stkcode <span class="kw">IN</span> (<span class="st">&#39;FC&#39;</span>,<span class="st">&#39;BS&#39;</span>,<span class="st">&#39;NG&#39;</span>);</span></code></pre></div>
</div>
<div id="updating-all-rows" class="section level3 unnumbered">
<h3>Updating all rows</h3>
<p>All rows in a table can be updated by simply omitting the WHERE clause.
To give everyone at The Expeditioner a 5 percent raise, use</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb187-1"><a href="sql.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> emp</span>
<span id="cb187-2"><a href="sql.html#cb187-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SET</span> empsalary <span class="op">=</span> empsalary<span class="op">*</span><span class="fl">1.05</span>;</span></code></pre></div>
</div>
<div id="updating-with-a-subquery" class="section level3 unnumbered">
<h3>Updating with a subquery</h3>
<p>A subquery can also be used to specify which rows should be changed.
Consider the following example. The employees in the departments on the
fourth floor of The Expeditioner have won a productivity improvement
bonus of 10 percent. The following SQL statement would update their
salaries:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb188-1"><a href="sql.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> emp</span>
<span id="cb188-2"><a href="sql.html#cb188-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SET</span> empsalary <span class="op">=</span> empsalary<span class="op">*</span><span class="fl">1.10</span></span>
<span id="cb188-3"><a href="sql.html#cb188-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> deptname <span class="kw">IN</span></span>
<span id="cb188-4"><a href="sql.html#cb188-4" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">SELECT</span> deptname <span class="kw">FROM</span> dept <span class="kw">WHERE</span> deptfloor <span class="op">=</span> <span class="dv">4</span>);</span></code></pre></div>
</div>
</div>
<div id="delete-1" class="section level2 unnumbered">
<h2>DELETE</h2>
<p>The DELETE statement erases one or more rows in a table. The general
format is</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb189-1"><a href="sql.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> <span class="kw">table</span></span>
<span id="cb189-2"><a href="sql.html#cb189-2" aria-hidden="true" tabindex="-1"></a>    [<span class="kw">WHERE</span> condition];</span></code></pre></div>
<div id="delete-a-single-record" class="section level3 unnumbered">
<h3>Delete a single record</h3>
<p>If all stocks with stkcode equal to “BE” were sold, then this row can be
deleted using</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb190-1"><a href="sql.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> stock <span class="kw">WHERE</span> stkcode <span class="op">=</span> <span class="st">&#39;BE&#39;</span>;</span></code></pre></div>
</div>
<div id="delete-multiple-records" class="section level3 unnumbered">
<h3>Delete multiple records</h3>
<p>If all Australian stocks were liquidated, then the following command
would delete all the relevant rows:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb191-1"><a href="sql.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> stock</span>
<span id="cb191-2"><a href="sql.html#cb191-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> natcode <span class="kw">in</span></span>
<span id="cb191-3"><a href="sql.html#cb191-3" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">SELECT</span> natcode <span class="kw">FROM</span> nation <span class="kw">WHERE</span> natname <span class="op">=</span> <span class="st">&#39;Australia&#39;</span>);</span></code></pre></div>
</div>
<div id="delete-all-records" class="section level3 unnumbered">
<h3>Delete all records</h3>
<p>All records in a table can be deleted by omitting the WHERE clause. The
following statement would delete all rows if the entire portfolio were
sold:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb192-1"><a href="sql.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> stock;</span></code></pre></div>
<p>This command is not the same as DROP TABLE because, although the table
is empty, it still exists.</p>
</div>
<div id="delete-with-a-subquery" class="section level3 unnumbered">
<h3>Delete with a subquery</h3>
<p>Despite their sterling efforts in the recent productivity drive, all the
employees on the fourth floor of The Expeditioner have been fired (the
rumor is that they were fiddling the tea money). Their records can be
deleted using</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb193-1"><a href="sql.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> emp</span>
<span id="cb193-2"><a href="sql.html#cb193-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> deptname <span class="kw">IN</span> </span>
<span id="cb193-3"><a href="sql.html#cb193-3" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">SELECT</span> deptname <span class="kw">FROM</span> dept <span class="kw">WHERE</span> deptfloor <span class="op">=</span> <span class="dv">4</span>);</span></code></pre></div>
</div>
</div>
<div id="sql-routines" class="section level2 unnumbered">
<h2>SQL routines</h2>
<p>SQL provides two types of routines—functions and procedures—that are
created, altered, and dropped using standard SQL. Routines add
flexibility, improve programmer productivity, and facilitate the
enforcement of business rules and standard operating procedures across
applications.</p>
</div>
<div id="sql-function" class="section level2 unnumbered">
<h2>SQL function</h2>
<p>A function is SQL code that returns a value when invoked within an SQL
statement. It is used in a similar fashion to SQL’s built-in functions.
Consider the case of an Austrian firm with a database in which all
measurements are in SI units (e.g., meters). Because its U.S. staff is
not familiar with SI,<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> it decides to implement a series of
user-defined functions to handle the conversion. Here is the function
for converting from kilometers to miles.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb194-1"><a href="sql.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">FUNCTION</span> km_to_miles(km <span class="dt">REAL</span>)</span>
<span id="cb194-2"><a href="sql.html#cb194-2" aria-hidden="true" tabindex="-1"></a>    RETURNS <span class="dt">REAL</span></span>
<span id="cb194-3"><a href="sql.html#cb194-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">RETURN</span> <span class="fl">0.6213712</span><span class="op">*</span>km;</span></code></pre></div>
<p>The preceding function can be used within any SQL statement to make the
conversion. For example:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb195-1"><a href="sql.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> km_to_miles(<span class="dv">100</span>);</span></code></pre></div>
<blockquote>
<p>❓<em>Skill builder</em></p>
<p>Create a table containing the average daily temperature in Tromsø,
Norway, then write a function to convert Celsius to Fahrenheit (F =
C*1.8 + 32), and test the function by reporting temperatures in C and
F.</p>
<table>
<thead>
<tr class="header">
<th align="left">Month</th>
<th align="left">Jan</th>
<th align="left">Feb</th>
<th align="left">Mar</th>
<th align="left">Apr</th>
<th align="left">May</th>
<th align="left">Jun</th>
<th align="left">Jul</th>
<th align="left">Aug</th>
<th align="left">Sep</th>
<th align="left">Oct</th>
<th align="left">Nov</th>
<th align="left">Dec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ºC</td>
<td align="left">-4.7</td>
<td align="left">-4.1</td>
<td align="left">-1.9</td>
<td align="left">1.1</td>
<td align="left">5.6</td>
<td align="left">10.1</td>
<td align="left">12.7</td>
<td align="left">11.8</td>
<td align="left">7.7</td>
<td align="left">2.9</td>
<td align="left">-1.5</td>
<td align="left">-3.7</td>
</tr>
</tbody>
</table>
</blockquote>
</div>
<div id="sql-procedure" class="section level2 unnumbered">
<h2>SQL procedure</h2>
<p>A procedure is SQL code that is dynamically loaded and executed by a
CALL statement, usually within a database application. We use an
accounting system to demonstrate the features of a stored procedure, in
which a single accounting transaction results in two entries (one debit
and one credit). In other words, a transaction has multiple entries, but
an entry is related to only one transaction. An account (e.g., your bank
account) has multiple entries, but an entry is for only one account.
Considering this situation results in the following data model.</p>
<p><em>A simple accounting system</em></p>
<p><img src="Figures/Chapter%2010/accounting.png" /></p>
<p>The following are a set of steps for processing a transaction (e.g.,
transferring money from a checking account to a money market account):</p>
<ol style="list-style-type: decimal">
<li><p>Write the transaction to the transaction table so you have a record
of the transaction.</p></li>
<li><p>Update the account to be credited by incrementing its balance in the
account table.</p></li>
<li><p>Insert a row in the entry table to record the credit.</p></li>
<li><p>Update the account to be debited by decrementing its balance in the
account table.</p></li>
<li><p>Insert a row in the entry table to record the debit.</p></li>
</ol>
<p>Here is the code for a stored procedure to execute these steps. Note
that the first line sets the delimiter to // because the default
delimiter for SQL is a semicolon (;), which we need to use to delimit
the multiple SQL commands in the procedure. The last statement in the
procedure is thus END // to indicate the end of the procedure.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb196-1"><a href="sql.html#cb196-1" aria-hidden="true" tabindex="-1"></a>DELIMITER <span class="op">//</span></span>
<span id="cb196-2"><a href="sql.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">PROCEDURE</span> transfer (</span>
<span id="cb196-3"><a href="sql.html#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="kw">IN</span> `Credit account` <span class="dt">INTEGER</span>, </span>
<span id="cb196-4"><a href="sql.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="kw">IN</span> `Debit account` <span class="dt">INTEGER</span>, </span>
<span id="cb196-5"><a href="sql.html#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="kw">IN</span> Amount <span class="dt">DECIMAL</span>(<span class="dv">9</span>,<span class="dv">2</span>),</span>
<span id="cb196-6"><a href="sql.html#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="kw">IN</span> `Transaction ID` <span class="dt">INTEGER</span>)</span>
<span id="cb196-7"><a href="sql.html#cb196-7" aria-hidden="true" tabindex="-1"></a>LANGUAGE SQL</span>
<span id="cb196-8"><a href="sql.html#cb196-8" aria-hidden="true" tabindex="-1"></a>DETERMINISTIC</span>
<span id="cb196-9"><a href="sql.html#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="cf">BEGIN</span></span>
<span id="cb196-10"><a href="sql.html#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> <span class="kw">transaction</span> <span class="kw">VALUES</span> (`Transaction ID`, Amount, <span class="fu">CURRENT_DATE</span>);</span>
<span id="cb196-11"><a href="sql.html#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> <span class="kw">account</span></span>
<span id="cb196-12"><a href="sql.html#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> acctbalance <span class="op">=</span> acctbalance <span class="op">+</span> Amount</span>
<span id="cb196-13"><a href="sql.html#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> acctno <span class="op">=</span> `Credit account`;</span>
<span id="cb196-14"><a href="sql.html#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> <span class="kw">entry</span> <span class="kw">VALUES</span> (`Transaction ID`, `Credit account`, <span class="st">&#39;cr&#39;</span>);</span>
<span id="cb196-15"><a href="sql.html#cb196-15" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> <span class="kw">account</span></span>
<span id="cb196-16"><a href="sql.html#cb196-16" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> acctbalance <span class="op">=</span> acctbalance <span class="op">-</span> Amount</span>
<span id="cb196-17"><a href="sql.html#cb196-17" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> acctno <span class="op">=</span> `Debit account`;</span>
<span id="cb196-18"><a href="sql.html#cb196-18" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> <span class="kw">entry</span> <span class="kw">VALUES</span> (`Transaction ID`, `Debit account`, <span class="st">&#39;db&#39;</span>);</span>
<span id="cb196-19"><a href="sql.html#cb196-19" aria-hidden="true" tabindex="-1"></a><span class="cf">END</span><span class="op">//</span></span></code></pre></div>
<p>A CALL statement executes a stored procedure. The generic CALL statement
for the preceding procedure is</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb197-1"><a href="sql.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CALL</span> transfer(cracct, dbacct, amt, transno);</span></code></pre></div>
<p>Thus, imagine that transaction 1005 transfers $100 to account 1 (the
credit account) from account 2 (the debit account). The specific call is</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb198-1"><a href="sql.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CALL</span> transfer(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">100</span>,<span class="dv">1005</span>);</span></code></pre></div>
<blockquote>
<p>❓<em>Skill builder</em></p>
<ol style="list-style-type: decimal">
<li><p>After verifying that the system you use for learning SQL supports
stored procedures, create the tables for the preceding data model
and enter the code for the stored procedure. Now, test the stored
procedure and query the tables to verify that the procedure has
worked.</p></li>
<li><p>Write a stored procedure to add details of a gift to the donation
database (see exercises in Chapter 5).</p></li>
</ol>
</blockquote>
</div>
<div id="trigger" class="section level2 unnumbered">
<h2>Trigger</h2>
<p>A trigger is a form of stored procedure that executes automatically when
a table’s rows are modified. Triggers can be defined to execute either
before or after rows are inserted into a table, when rows are deleted
from a table, and when columns are updated in the rows of a table.
Triggers can include virtual tables that reflect the row image before
and after the operation, as appropriate. Triggers can be used to enforce
business rules or requirements, integrity checking, and automatic
transaction logging.</p>
<p>Consider the case of recording all updates to the <code>stock</code> table (see
Chapter 4). First, you must define a table in which to record details of
the change.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb199-1"><a href="sql.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> stock_log (</span>
<span id="cb199-2"><a href="sql.html#cb199-2" aria-hidden="true" tabindex="-1"></a>stkcode     <span class="dt">CHAR</span>(<span class="dv">3</span>),</span>
<span id="cb199-3"><a href="sql.html#cb199-3" aria-hidden="true" tabindex="-1"></a>old_stkprice    <span class="dt">DECIMAL</span>(<span class="dv">6</span>,<span class="dv">2</span>),</span>
<span id="cb199-4"><a href="sql.html#cb199-4" aria-hidden="true" tabindex="-1"></a>new_stkprice    <span class="dt">DECIMAL</span>(<span class="dv">6</span>,<span class="dv">2</span>),</span>
<span id="cb199-5"><a href="sql.html#cb199-5" aria-hidden="true" tabindex="-1"></a>old_stkqty      <span class="dt">DECIMAL</span>(<span class="dv">8</span>),</span>
<span id="cb199-6"><a href="sql.html#cb199-6" aria-hidden="true" tabindex="-1"></a>new_stkqty      <span class="dt">DECIMAL</span>(<span class="dv">8</span>),</span>
<span id="cb199-7"><a href="sql.html#cb199-7" aria-hidden="true" tabindex="-1"></a>update_stktime  <span class="dt">TIMESTAMP</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb199-8"><a href="sql.html#cb199-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(update_stktime));</span></code></pre></div>
<p>The trigger writes a record to <code>stock_log</code> every time an update is made
to <code>stock</code>. Use is made of two virtual tables (<code>old</code> and <code>new</code>) to
access the prior and current values of stock price (<code>old.stkprice</code> and
<code>new.stkprice</code>) and stock quantity (<code>old.stkprice</code> and <code>new.stkprice</code>).
The INSERT statement also writes the stock’s identifying code and the
time of the transaction.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb200-1"><a href="sql.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TRIGGER</span> stock_update</span>
<span id="cb200-2"><a href="sql.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="kw">AFTER</span> <span class="kw">UPDATE</span> <span class="kw">ON</span> stock</span>
<span id="cb200-3"><a href="sql.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="cf">FOR</span> <span class="kw">EACH</span> <span class="kw">ROW</span> <span class="cf">BEGIN</span></span>
<span id="cb200-4"><a href="sql.html#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> stock_log <span class="kw">VALUES</span></span>
<span id="cb200-5"><a href="sql.html#cb200-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">old</span>.stkcode, <span class="kw">old</span>.stkprice, <span class="kw">new</span>.stkprice, <span class="kw">old</span>.stkqty, <span class="kw">new</span>.stkqty, <span class="fu">CURRENT_TIMESTAMP</span>);</span>
<span id="cb200-6"><a href="sql.html#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="cf">END</span></span></code></pre></div>
<blockquote>
<p>❓<em>Skill builder</em> Why is the primary key of <code>stock_log</code> not the same as
that of stock?</p>
</blockquote>
</div>
<div id="nullsmuch-ado-about-missing-information" class="section level2 unnumbered">
<h2>Nulls—much ado about missing information</h2>
<p>Nulls are overworked in SQL because they can represent several
situations. Null can represent unknown information. For example, you
might add a new stock to the database, but lacking details of its latest
dividend, you leave the field null. Null can be used to represent a
value that is inapplicable. For instance, the employee table contains a
null value in bossno for Alice because she has no boss. The value is not
unknown; it is not applicable for that field. In other cases, null might
mean “no value supplied” or “value undefined.” Because null can have
multiple meanings, the client must infer which meaning is appropriate to
the circumstances.</p>
<p>Do not confuse null with blank or zero, which are values. In fact, null
is a marker that specifies that the value for the particular column is
null. Thus, null represents no value.</p>
<p>The well-known database expert Chris Date has been outspoken in his
concern about the confusion caused by nulls. His advice is that nulls
should be explicitly avoided by specifying NOT NULL for all columns and
by using codes to make the meaning of a value clear (e.g., “U” means
“unknown,” “I” means “inapplicable,” “N” means “not supplied”).</p>
</div>
<div id="security" class="section level2 unnumbered">
<h2>Security</h2>
<p>Data are a valuable resource for nearly every organization. Just as an
organization takes measures to protect its physical assets, it also
needs to safeguard its electronic assets—its organizational memory,
including databases. Furthermore, it often wants to limit the access of
authorized users to particular parts of a database and restrict their
actions to particular operations.</p>
<p>Two SQL features are used to administer security procedures. A view,
discussed earlier in this chapter, can restrict a client’s access to
specified columns or rows in a table, and authorization commands can
establish a user’s privileges.</p>
<p>The authorization subsystem is based on the concept of a privilege—the
authority to perform an operation. For example, a person cannot update a
table unless she has been granted the appropriate update privilege. The
database administrator (DBA) is a master of the universe and has the
highest privilege. The DBA can perform any legal operation. The creator
of an object, say a base table, has full privileges for that object.
Those with privileges can then use GRANT and REVOKE, commands included
in SQL’s data control language (DCL) to extend privileges to or rescind
them from other users.</p>
</div>
<div id="grant" class="section level2 unnumbered">
<h2>GRANT</h2>
<p>The GRANT command defines a client’s privileges. The general format of
the statement is</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb201-1"><a href="sql.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">privileges</span> <span class="kw">ON</span> <span class="dt">object</span> <span class="kw">TO</span> users [<span class="kw">WITH</span> <span class="kw">GRANT</span> <span class="kw">OPTION</span>];</span></code></pre></div>
<p>where “privileges” can be a list of privileges or the keyword ALL
PRIVILEGES, and “users” is a list of user identifiers or the keyword
PUBLIC. An “object” can be a base table or a view.</p>
<p>The following privileges can be granted for tables and views: SELECT,
UPDATE, DELETE, and INSERT.</p>
<p>The UPDATE privilege specifies the particular columns in a base table or
view that may be updated. Some privileges apply <em>only</em> to base tables.
These are ALTER and INDEX.</p>
<p>The following examples illustrate the use of GRANT:</p>
<p><em>Give Alice all rights to the stock table.</em></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb202-1"><a href="sql.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">ALL</span> <span class="kw">PRIVILEGES</span> <span class="kw">ON</span> stock <span class="kw">TO</span> alice;</span></code></pre></div>
<p><em>Permit the accounting staff, Todd and Nancy, to update the price of a
stock.</em></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb203-1"><a href="sql.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span> (stkprice) <span class="kw">ON</span> stock <span class="kw">TO</span> todd, nancy;</span></code></pre></div>
<p><em>Give all staff the privilege to select rows from item.</em></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb204-1"><a href="sql.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> item <span class="kw">TO</span> <span class="kw">PUBLIC</span>;</span></code></pre></div>
<p><em>Give Alice all rights to view stk.</em></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb205-1"><a href="sql.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span>, <span class="kw">UPDATE</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> stk <span class="kw">TO</span> alice;</span></code></pre></div>
<div id="the-with-grant-option-clause" class="section level3 unnumbered">
<h3>The WITH GRANT OPTION clause</h3>
<p>The WITH GRANT OPTION command allows a client to transfer his privileges
to another client, as this next example illustrates:</p>
<p><em>Give Ned all privileges for the item table and permit him to grant any
of these to other staff members who may need to work with item.</em></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb206-1"><a href="sql.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">ALL</span> <span class="kw">PRIVILEGES</span> <span class="kw">ON</span> item <span class="kw">TO</span> ned <span class="kw">WITH</span> <span class="kw">GRANT</span> <span class="kw">OPTION</span>;</span></code></pre></div>
<p>This means that Ned can now use the GRANT command to give other staff
privileges. To give Andrew permission for select and insert on item, for
example, Ned would enter</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb207-1"><a href="sql.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> item <span class="kw">TO</span> andrew;</span></code></pre></div>
</div>
</div>
<div id="revoke" class="section level2 unnumbered">
<h2>REVOKE</h2>
<p>What GRANT granteth, REVOKE revoketh. Privileges are removed using the
REVOKE statement. The general format of this statement is</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb208-1"><a href="sql.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="kw">REVOKE</span> <span class="kw">privileges</span> <span class="kw">ON</span> <span class="dt">object</span> <span class="kw">FROM</span> users;</span></code></pre></div>
<p>These examples illustrate the use of REVOKE.</p>
<p><em>Remove Sophie’s ability to select from item.</em></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb209-1"><a href="sql.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="kw">REVOKE</span> <span class="kw">SELECT</span> <span class="kw">ON</span> item <span class="kw">FROM</span> sophie;</span></code></pre></div>
<p><em>Nancy is no longer permitted to update stock prices.</em></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb210-1"><a href="sql.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="kw">REVOKE</span> <span class="kw">UPDATE</span> <span class="kw">ON</span> stock <span class="kw">FROM</span> nancy;</span></code></pre></div>
<div id="cascading-revoke" class="section level3 unnumbered">
<h3>Cascading revoke</h3>
<p>When a REVOKE statement removes a privilege, it can result in more than
one revocation. An earlier example illustrated how Ned used his WITH
GRANT OPTION right to authorize Andrew to select and insert rows on
item. The following REVOKE command</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb211-1"><a href="sql.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="kw">REVOKE</span> <span class="kw">INSERT</span> <span class="kw">ON</span> item <span class="kw">FROM</span> ned;</span></code></pre></div>
<p>automatically revokes Andrew’s insert privilege.</p>
</div>
</div>
<div id="the-system-catalog" class="section level2 unnumbered">
<h2>The system catalog</h2>
<p>The system catalog describes a relational database. It contains the
definitions of base tables, views, indexes, and so on. The catalog
itself is a relational database and can be interrogated using SQL.
Tables in the catalog are called <em>system tables</em> to distinguish them
from base tables, though conceptually these tables are the same. In
MySQL, the system catalog is called information_schema. Some important
system tables in this schema are tables, and columns, and these are used
in the following examples. Note that the names of the system catalog
tables vary with DBMS implementations, so while the following examples
illustrate use of system catalog tables, it is likely that you will have
to change the table names for other DBMSs.</p>
<p>The table TABLES contains details of all tables in the database. There
is one row for each table in the database.</p>
<p><em>Find the table(s) with the most columns.</em></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb212-1"><a href="sql.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> table_name, table_rows</span>
<span id="cb212-2"><a href="sql.html#cb212-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> information_schema.<span class="kw">tables</span></span>
<span id="cb212-3"><a href="sql.html#cb212-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> table_rows <span class="op">=</span> (<span class="kw">SELECT</span> <span class="fu">MAX</span>(table_rows)</span>
<span id="cb212-4"><a href="sql.html#cb212-4" aria-hidden="true" tabindex="-1"></a>            <span class="kw">FROM</span> information_schema.<span class="kw">tables</span>);</span></code></pre></div>
<p>The <code>COLUMN</code> table stores details about each column in the database.</p>
<p><em>What columns in what tables store dates?</em></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb213-1"><a href="sql.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> table_name, column_name </span>
<span id="cb213-2"><a href="sql.html#cb213-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> information_schema.<span class="kw">columns</span></span>
<span id="cb213-3"><a href="sql.html#cb213-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> DATA_TYPE <span class="op">=</span> <span class="st">&#39;date&#39;</span></span>
<span id="cb213-4"><a href="sql.html#cb213-4" aria-hidden="true" tabindex="-1"></a>            <span class="kw">ORDER</span> <span class="kw">BY</span> table_name, column_name;</span></code></pre></div>
<p>As you can see, querying the catalog is the same as querying a database.
This is a useful feature because you can use SQL queries on the catalog
to find out more about a database.</p>
</div>
<div id="natural-language-processing" class="section level2 unnumbered">
<h2>Natural language processing</h2>
<p>Infrequent inquirers of a relational database may be reluctant to use
SQL because they don’t use it often enough to remain familiar with the
language. While the QBE approach can make querying easier, a more
natural approach is to use standard English. In this case, natural
language processing (NLP) is used to convert ordinary English into SQL
so the query can be passed to the relational database. The example in
the table below shows the successful translation of a query to SQL. A
natural language processor must translate a request to SQL and request
clarification where necessary.</p>
<p><em>An example of natural language processing</em></p>
<table style="width:99%;">
<colgroup>
<col width="23%" />
<col width="75%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">English</th>
<th align="left">SQL generated for MS Access</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Which movies
have won best
foreign film
sorted by
year?</td>
<td align="left">SELECT DISTINCT <span class="math display">\[Year\]</span>, <span class="math display">\[Title\]</span> FROM <span class="math display">\[Awards\]</span>
INNER JOIN <span class="math display">\[Movies\]</span> ON <span class="math display">\[Movies\]</span>.<span class="math display">\[Movie ID\]</span> =
<span class="math display">\[Awards\]</span>.<span class="math display">\[Movie ID\]</span> WHERE <span class="math display">\[Category\]</span>=‘Best
Foreign Film’ and <span class="math display">\[Status\]</span>=‘Winner’ ORDER BY
<span class="math display">\[Year\]</span> ASC;</td>
</tr>
</tbody>
</table>
</div>
<div id="connectivity-and-odbc" class="section level2 unnumbered">
<h2>Connectivity and ODBC</h2>
<p>Over time and because of differing needs, an organization is likely to
purchase DBMS software from a variety of vendors. Also, in some
situations, mergers and acquisitions can create a multivendor DBMS
environment. Consequently, the SQL Access Group developed SQL Call-Level
Interface (CLI), a unified standard for remote database access. The
intention of CLI is to provide programmers with a generic approach for
writing software that accesses a database. With the appropriate CLI
database driver, any DBMS server can provide access to client programs
that use the CLI. On the server side, the DBMS CLI driver is responsible
for translating the CLI call into the server’s access language. On the
client side, there must be a CLI driver for each database to which it
connects. CLI is not a query language but a way of wrapping SQL so it
can be understood by a DBMS. In 1996, CLI was adopted as an
international standard and renamed X/Open CLI.</p>
</div>
<div id="open-database-connectivity-odbc" class="section level2 unnumbered">
<h2>Open database connectivity (ODBC)</h2>
<p>The de facto standard for database connectivity is <strong>Open Database
Connectivity</strong> (ODBC), an extended implementation of CLI developed by
Microsoft. This application programming interface (API) is
cross-platform and can be used to access any DBMS that has an ODBC
driver. This enables a software developer to build and distribute an
application without targeting a specific DBMS. Database drivers are then
added to link the application to the client’s choice of DBMS. For
example, a microcomputer running under Windows can use ODBC to access an
Oracle DBMS running on a Unix box.</p>
<p>There is considerable support for ODBC. Application vendors like it
because they do not have to write and maintain code for each DBMS; they
can write one API. DBMS vendors support ODBC because they do not have to
convince application vendors to support their product. For database
systems managers, ODBC provides vendor and platform independence.
Although the ODBC API was originally developed to provide database
access from MS Windows products, many ODBC driver vendors support Linux
and Macintosh clients.</p>
<p>Most vendors also have their own SQL APIs. The problem is that most
vendors, as a means of differentiating their DBMS, have a more extensive
native API protocol and also add extensions to standard ODBC. The
developer who is tempted to use these extensions threatens the
portability of the database.</p>
<p>ODBC introduces greater complexity and a processing overhead because it
adds two layers of software. As the following figure illustrates, an
ODBC-compliant application has additional layers for the ODBC API and
ODBC driver. As a result, ODBC APIs can never be as fast as native APIs.</p>
<p><em>ODBC layers</em></p>
<table>
<thead>
<tr class="header">
<th align="left">Application</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ODBC API</td>
</tr>
<tr class="even">
<td align="left">ODBC driver manager</td>
</tr>
<tr class="odd">
<td align="left">Service provider API</td>
</tr>
<tr class="even">
<td align="left">Driver for DBMS server</td>
</tr>
<tr class="odd">
<td align="left">DBMS server</td>
</tr>
</tbody>
</table>
</div>
<div id="embedded-sql" class="section level2 unnumbered">
<h2>Embedded SQL</h2>
<p>SQL can be used in two modes. <em>First,</em> SQL is an interactive query
language and database programming language. SELECT defines queries;
INSERT, UPDATE, and DELETE maintain a database. <em>Second</em>, any
interactive SQL statement can be embedded in an application program.</p>
<p>This dual-mode principle is a very useful feature. It means that
programmers need to learn only one database query language, because the
same SQL statements apply for both interactive queries and application
statements. Programmers can also interactively examine SQL commands
before embedding them in a program, a feature that can substantially
reduce the time to write an application program.</p>
<p>Because SQL is not a complete programming language, however, it must be
used with a traditional programming language to create applications.
Common complete programming languages, such as PHP and Java, support
embedded SQL. If you are need to write application programs using
embedded SQL, you will need training in both the application language
and the details of how it communicates with SQL.</p>
</div>
<div id="user-defined-types" class="section level2 unnumbered">
<h2>User-defined types</h2>
<p>Versions of SQL prior to the SQL-99 specification had predefined data
types, and programmers were limited to selecting the data type and
defining the length of character strings. One of the basic ideas behind
the object extensions of the SQL standard is that, in addition to the
normal built-in data types defined by SQL, <strong>user-defined data types</strong>
(UDTs) are available. A UDT is used like a predefined type, but it must
be set up before it can be used.</p>
</div>
<div id="the-future-of-sql" class="section level2 unnumbered">
<h2>The future of SQL</h2>
<p>Since 1986, developers of database applications have benefited from an
SQL standard, one of the most successful standardization stories in the
software industry. Although most database vendors have implemented
proprietary extensions of SQL, standardization has kept the language
consistent, and SQL code is highly portable. Standardization was
relatively easy when focused on the storage and retrieval of numbers and
characters. Objects have made standardization more difficult.</p>
</div>
<div id="summary-10" class="section level2 unnumbered">
<h2>Summary</h2>
<p>Structured Query Language (SQL), a widely used relational database
language, has been adopted as a standard by ANSI and ISO. It is a data
definition language (DDL), data manipulation language (DML), and data
control language (DCL). A base table is an autonomous, named table. A
view is a virtual table. A key is one or more columns identified as such
in the description of a table, an index, or a referential constraint.
SQL supports primary, foreign, and unique keys. Indexes accelerate data
access and ensure uniqueness. CREATE TABLE defines a new base table and
specifies primary, foreign, and unique key constraints. Numeric, string,
date, or graphic data can be stored in a column. BLOB and CLOB are data
types for large fields. ALTER TABLE adds one new column to a table or
changes the status of a constraint. DROP TABLE removes a table from a
database. CREATE VIEW defines a view, which can be used to restrict
access to data, report derived data, store commonly executed queries,
and convert data. A view is created dynamically. DROP VIEW deletes a
view. CREATE INDEX defines an index, and DROP INDEX deletes one.</p>
<p>Ambiguous references to column names are avoided by qualifying a column
name with its table name. A table or view can be given a temporary name
that remains current for a query. SQL has four data manipulation
statements—SELECT, INSERT, UPDATE, and DELETE. INSERT adds one or more
rows to a table. UPDATE modifies a table by changing one or more rows.
DELETE removes one or more rows from a table. SELECT provides powerful
interrogation facilities. The product of two tables is a new table
consisting of all rows of the first table concatenated with all possible
rows of the second table. Join creates a new table from two existing
tables by matching on a column common to both tables. A subquery is a
query within a query. A correlated subquery differs from a simple
subquery in that the inner query is evaluated multiple times rather than
once.</p>
<p>SQL’s aggregate functions increase its retrieval power. GROUP BY
supports grouping of rows that have the same value for a specified
column. The REXEXP clause supports pattern matching. SQL includes scalar
functions that can be used in arithmetic expressions, data conversion,
or data extraction. Nulls cause problems because they can represent
several situations—unknown information, inapplicable information, no
value supplied, or value undefined. Remember, a null is not a blank or
zero. The SQL commands, GRANT and REVOKE, support data security. GRANT
authorizes a user to perform certain SQL operations, and REVOKE removes
a user’s authority. The system catalog, which describes a relational
database, can be queried using SELECT. SQL can be used as an interactive
query language and as embedded commands within an application
programming language. Natural language processing (NLP) and open
database connectivity (ODBC) are extensions to relational technology
that enhance its usefulness.</p>
</div>
<div id="key-terms-and-concepts-7" class="section level2 unnumbered">
<h2>Key terms and concepts</h2>
<table>
<tbody>
<tr class="odd">
<td align="left">Aggregate functions</td>
<td align="left">GROUP BY</td>
</tr>
<tr class="even">
<td align="left">ALTER TABLE</td>
<td align="left">Index</td>
</tr>
<tr class="odd">
<td align="left">ANSI</td>
<td align="left">INSERT</td>
</tr>
<tr class="even">
<td align="left">Base table</td>
<td align="left">ISO</td>
</tr>
<tr class="odd">
<td align="left">Complete database language</td>
<td align="left">Join</td>
</tr>
<tr class="even">
<td align="left">Complete programming language</td>
<td align="left">Key</td>
</tr>
<tr class="odd">
<td align="left">Composite key</td>
<td align="left">Natural language processing (NLP)</td>
</tr>
<tr class="even">
<td align="left">Connectivity</td>
<td align="left">Null</td>
</tr>
<tr class="odd">
<td align="left">Correlated subquery</td>
<td align="left">Open database connectivity (ODBC)</td>
</tr>
<tr class="even">
<td align="left">CREATE FUNCTION</td>
<td align="left">Primary key</td>
</tr>
<tr class="odd">
<td align="left">CREATE INDEX</td>
<td align="left">Product</td>
</tr>
<tr class="even">
<td align="left">CREATE PROCEDURE</td>
<td align="left">Qualified name</td>
</tr>
<tr class="odd">
<td align="left">CREATE TABLE</td>
<td align="left">Referential integrity rule</td>
</tr>
<tr class="even">
<td align="left">CREATE TRIGGER</td>
<td align="left">REVOKE</td>
</tr>
<tr class="odd">
<td align="left">CREATE VIEW</td>
<td align="left">Routine</td>
</tr>
<tr class="even">
<td align="left">Cursor</td>
<td align="left">Scalar functions</td>
</tr>
<tr class="odd">
<td align="left">Data control language (DCL)</td>
<td align="left">Security</td>
</tr>
<tr class="even">
<td align="left">Data definition language (DDL)</td>
<td align="left">SELECT</td>
</tr>
<tr class="odd">
<td align="left">Data manipulation language (DML)</td>
<td align="left">Special registers</td>
</tr>
<tr class="even">
<td align="left">Data types</td>
<td align="left">SQL</td>
</tr>
<tr class="odd">
<td align="left">DELETE</td>
<td align="left">Subquery</td>
</tr>
<tr class="even">
<td align="left">DROP INDEX</td>
<td align="left">Synonym</td>
</tr>
<tr class="odd">
<td align="left">DROP TABLE</td>
<td align="left">System catalog</td>
</tr>
<tr class="even">
<td align="left">DROP VIEW</td>
<td align="left">Temporary names</td>
</tr>
<tr class="odd">
<td align="left">Embedded SQL</td>
<td align="left">Unique key</td>
</tr>
<tr class="even">
<td align="left">Foreign key</td>
<td align="left">UPDATE</td>
</tr>
<tr class="odd">
<td align="left">GRANT</td>
<td align="left">View</td>
</tr>
</tbody>
</table>
</div>
<div id="references-and-additional-readings-5" class="section level2 unnumbered">
<h2>References and additional readings</h2>
<p>Date, C. J. 2003. <em>An introduction to database systems</em>. 8th ed.
Reading, MA: Addison-Wesley.</p>
</div>
<div id="exercises-9" class="section level2 unnumbered">
<h2>Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Why is it important that SQL was adopted as a standard by ANSI and
ISO?</p></li>
<li><p>What does it mean to say “SQL is a complete database language”?</p></li>
<li><p>Is SQL a complete programming language? What are the implications of
your answer?</p></li>
<li><p>List some operational advantages of a DBMS.</p></li>
<li><p>What is the difference between a base table and a view?</p></li>
<li><p>What is the difference between a primary key and a unique key?</p></li>
<li><p>What is the purpose of an index?</p></li>
<li><p>Consider the three choices for the ON DELETE clause associated with
the foreign key constraint. What are the pros and cons of each
option?</p></li>
<li><p>Specify the data type (e.g., DECIMAL(6,2)) you would use for the
following columns:</p>
<ol style="list-style-type: lower-alpha">
<li><p>The selling price of a house</p></li>
<li><p>A telephone number with area code</p></li>
<li><p>Hourly temperatures in Antarctica</p></li>
<li><p>A numeric customer code</p></li>
<li><p>A credit card number</p></li>
<li><p>The distance between two cities</p></li>
<li><p>A sentence using Chinese characters</p></li>
<li><p>The number of kilometers from the Earth to a given star</p></li>
<li><p>The text of an advertisement in the classified section of a
newspaper</p></li>
<li><p>A basketball score</p></li>
<li><p>The title of a CD</p></li>
<li><p>The X-ray of a patient</p></li>
<li><p>A U.S. zip code</p></li>
<li><p>A British or Canadian postal code</p></li>
<li><p>The photo of a customer</p></li>
<li><p>The date a person purchased a car</p></li>
<li><p>The time of arrival of an e-mail message</p></li>
<li><p>The number of full-time employees in a small business</p></li>
<li><p>The text of a speech</p></li>
<li><p>The thickness of a layer on a silicon chip</p></li>
</ol></li>
<li><p>What is the difference between DROP TABLE and deleting all the rows
in a table?</p></li>
<li><p>Give some reasons for creating a view.</p></li>
<li><p>When is a view created?</p></li>
<li><p>Write SQL codes to create a unique index on firm name for the share
table defined in Chapter 3. Would it make sense to create a unique
index for PE ratio in the same table?</p></li>
<li><p>What is the difference between product and join?</p></li>
<li><p>What is the difference between an equijoin and a natural join?</p></li>
<li><p>You have a choice between executing two queries that will both give
the same result. One is written as a simple subquery and the other
as a correlated subquery. Which one would you use and why?</p></li>
<li><p>What function would you use for the following situations?</p>
<ol style="list-style-type: lower-alpha">
<li><p>Computing the total value of a column</p></li>
<li><p>Finding the minimum value of a column</p></li>
<li><p>Counting the number of customers in the customer table</p></li>
<li><p>Displaying a number with specified precision</p></li>
<li><p>Reporting the month part of a date</p></li>
<li><p>Displaying the second part of a time</p></li>
<li><p>Retrieving the first five characters of a city’s name</p></li>
<li><p>Reporting the distance to the sun in feet</p></li>
</ol></li>
<li><p>Write SQL statements for the following:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Let Hui-Tze query and add to the nation table.</p></li>
<li><p>Give Lana permission to update the phone number column in the
customer table.</p></li>
<li><p>Remove all of William’s privileges.</p></li>
<li><p>Give Chris permission to grant other users authority to select
from the address table.</p></li>
<li><p>Find the name of all tables that include the word sale.</p></li>
<li><p>List all the tables created last year.</p></li>
<li><p>What is the maximum length of the column city in the
ClassicModels database? Why do you get two rows in the response?</p></li>
<li><p>Find all columns that have a data type of SMALLINT.</p></li>
</ol></li>
<li><p>What are the two modes in which you can use SQL?</p></li>
<li><p>Using the Classic Models database, write an SQL procedure to change
the credit limit of all customers in a specified country by a
specified amount. Provide before and after queries to show your
procedure works.</p></li>
<li><p>How do procedural programming languages and SQL differ in the way
they process data? How is this difference handled in an application
program? What is embedded SQL?</p></li>
<li><p>Using the Classic Models database, write an SQL procedure to change
the MSRP of all products in a product line by a specified
percentage. Provide before and after queries to show your procedure
works.</p></li>
</ol>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p>The international system of units of measurement. SI is the
from French <em>Système International</em>.<a href="sql.html#fnref19" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-relational-model-and-relational-algebra.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reference-2-sql-playbook.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DataManagement.pdf", "DataManagement.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
